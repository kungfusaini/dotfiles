(self.webpackChunk=self.webpackChunk||[]).push([[4100],{17054:(e,t,i)=>{i.d(t,{D:()=>n});var n,r,o=i(58303),s=i(90023),a=i(6655),l=i(88347);(r=n||(n={})).transformPosition=(e,t)=>{const i=a.wQ.Position.rebase(e,t);return(!0===e.updatable?a.wQ.Position.isSquashed(i):!a.wQ.Position.hasEqualLength(e,i))?o.YP:o.G((0,l.Vx)(e,i))},r.transformAlertChanged=(e,t)=>{if(0===t.delta.ops.length)return o.G((0,l.Vx)(e,{rev:t.revision}));if(void 0!==e.transformJson){const i=a.lB.rebase(e.transformJson,t.delta);return a.lB.isSquashed(i)?o.YP:o.G((0,l.Vx)(e,{transformJson:i,rev:t.revision}))}return o.G(e)},r.transformAlert=(e,t)=>{if(0===t.delta.ops.length)return o.G((0,l.Vx)(e,{rev:t.revision}));const i=(0,s.zG)(a.wQ.hasPosition(e)?(0,r.transformPosition)(e,t.delta):o.G(e),o.UI((e=>(0,l.Vx)(e,{rev:t.revision}))));return(0,s.zG)(i,o.tS(a.wQ.matchBy(o.G,(e=>{const i=a.lB.rebase(e.transformJson,t.delta);return(!0===e.updatable?a.lB.isSquashed(i):!0!==a.lB.isValidAfterTransform(e.transformJson,i))?o.YP:o.G((0,l.Vx)(e,{transformJson:i}))}),(e=>{const i=a.lB.rebase(e.subalerts,t.delta);return a.lB.isSquashed(i)?o.YP:o.G((0,l.Vx)(e,{subalerts:i}))}))))},r.transformAttentionHeatmap=(e,t)=>{const i=e=>e.map((e=>a.Vm.Range.rebase(e,t.delta))),n=i(e.update),r=n.filter(a.Vm.Range.isSquashed).map((e=>e.id));return(0,l.Vx)(e,{rev:t.revision,add:i(e.add).filter((0,s.ff)(a.Vm.Range.isSquashed)),update:n.filter((0,s.ff)(a.Vm.Range.isSquashed)),remove:[...e.remove,...r]})}},96414:(e,t,i)=>{i.d(t,{Hq:()=>r,Vt:()=>n,wE:()=>o});const n="vBarCard",r="grammarly-extension-vBar-card",o="vBarCardPositionReference"},699:(e,t,i)=>{var n;i.d(t,{O:()=>n}),function(e){e.headerHeight=48,e.panelHeight=106,e.predictionsPreviewHeaderHeight=52,e.predictionInsightHeight=52,e.predictionInsightBottomMargin=16}(n||(n={}))},66061:(e,t,i)=>{i.d(t,{WT:()=>n,xR:()=>m});var n,r=i(49231);if(6168!=i.j)var o=i(13391);if(6168!=i.j)var s=i(47387);if(6168!=i.j)var a=i(20161);if(6168!=i.j)var l=i(84714);if(6168!=i.j)var c=i(8261);if(6168!=i.j)var u=i(25400);if(6168!=i.j)var d=i(55923);if(6168!=i.j)var h=i(30101);if(6168!=i.j)var p=i(78542);!function(e){e.gButton="gButton",e.card="card",e.sdui="sdui",e.emogenie="emogenie",e.proofitRequest="proofitRequest",e.proofitReview="proofitReview",e.getStartedChecklist="getStartedChecklist",e.snippetsAppAction="snippetsAppAction"}(n||(n={}));class m{constructor(e){this._params=e,this._dynamicAssistantService=new d._(["setCheckingService"]),this._dynamicAssistantController=new d._,this._openState=o.h.create("closed"),this._log=p.Y.create("AssistantDynamicService"),this._subs=[],this._handleAssistantOpenState=e=>{this._openState.set(e)},this.open=async e=>{if(this._dynamicAssistantController.instance)this._dynamicAssistantController.instance.open(e);else{const{assistantController:t}=await this.init();t.open(e)}},this._params.customizationsAssistantVisible&&this._subs.push(this._params.customizationsAssistantVisible.subscribe(this._handleAssistantOpenState))}get assistantOpenState(){return this._openState.view()}get view(){return this._dynamicAssistantController.viewInstance.view((e=>e?r.createElement(h.L,{chunkName:"assistant"},r.createElement(s.F.Fragment,null,e.view)):null))}get activeView(){return this._dynamicAssistantController.viewInstance.pipe(a.w((e=>e?e.activeView:l.of(null))))}async init(){if(this._dynamicAssistantController.instance&&this._dynamicAssistantService.instance)return{assistantService:this._dynamicAssistantService.instance,assistantController:this._dynamicAssistantController.instance};const e=this._params.toneAIDynamicService.get().initOnFirstAlert(),t=this._params.ethicalAIDynamicService.get().initOnFirstAlert(),n=this._params.snippetsFeatureDynamicService.get().viewFeatureOption;return Promise.all([i.e(8543),i.e(8226),i.e(9689),i.e(6248),i.e(6762),i.e(6131),i.e(2382),i.e(5123),i.e(9720),i.e(8603),i.e(8338),i.e(3695),i.e(1496),i.e(7087),i.e(1431),i.e(9837),i.e(9807),i.e(4901),i.e(1276),i.e(3426),i.e(7699),i.e(8368),i.e(8721)]).then(i.bind(i,23678)).then((({AssistantService:i,AssistantControllerImpl:r,LocalAssistantHighlightCollection:o})=>{var s;const a=this._params.createServiceParams(),l=new i({...a,highlights:null!==(s=a.highlights)&&void 0!==s?s:new o(this._params.highlights.get())}),u=new r({...this._params.createControllerParams(),assistantService:l,toneAIFeature:e,ethicalAIFeature:t,snippetsFeature:n,cardEvents:this._params.cardEvents,envFactory:c.OB,dapiActions:this._params.dapiActions},this._params.felog);return this._params.customizationsAssistantVisible||this._subs.push(u.openState.subscribe(this._handleAssistantOpenState)),this._dynamicAssistantService.set(l),this._dynamicAssistantController.set(u),{assistantService:l,assistantController:u}}))}close(){this._dynamicAssistantController.instance?this._dynamicAssistantController.instance.close():this._log.warn("it's impossible to close assistant if it isn't open")}initCheckingService(e){const t=u.p.getLazyProxyWithState((()=>e));t.lazyCheckingService.get(),this._dynamicAssistantService.instanceProxy.setCheckingService(t)}getHoveredStateBehavior(e){return this._dynamicAssistantService.viewInstance.pipe(a.w((t=>{const{hoverProvider:i}=t||this._params.createServiceParams();return i.getHoveredStateBehavior(e)})))}dispose(){[this._dynamicAssistantController.instance,this._dynamicAssistantService.instance].forEach((e=>{try{null==e||e.dispose()}catch(t){this._log.error(`failed trying to dispose ${typeof e} instance`,t)}})),this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}}},81442:(e,t,i)=>{i.d(t,{V:()=>n});var n,r=i(699);!function(e){e.defaultLayout={name:"default",anchorMargin:{top:r.O.headerHeight+r.O.panelHeight,bottom:0,left:16,right:16},anchorOrigin:{horizontal:"right",vertical:"top"},assistantOrigin:{horizontal:"left",vertical:"top"},repositioningStrategy:[{horizontal:"flip",vertical:"translate"},{horizontal:"translate",vertical:"translate"}]}}(n||(n={}))},25400:(e,t,i)=>{i.d(t,{p:()=>I});var n,r=i(59833),o=i(38538),s=i(39953),a=i(68330),l=i(9273),c=i(31491),u=i(69465),d=i(72106),h=i(12518),p=i(17572),m=i(58303),g=i(84358),f=i(6655),v=i(98665),_=i(17054),b=i(23031),y=i(97472),w=i(25961),E=i(38437),S=i(78542),C=i(60108);!function(e){let t;!function(e){e.unsafeToCAPI=e=>e,e.unsafeFromCAPI=e=>e}(t=e.AlertChangedWithRevision||(e.AlertChangedWithRevision={}))}(n||(n={}));class I{constructor(e,t,i,n,u,f){this._checkingService=e,this._checkingServiceState=t,this._alertsTransformer=i,this._textRevisionManager=n,this._getCAPIAlertById=u,this._customEventsFilter=f,this._subs=new a.w.Keeper,this.checkingState="idle",this.asyncChecksState={plagiarism:"idle",writing_expert_check:"idle",ai_detector:"idle",ai_studio:"idle",audience_adapt:"idle"},this.events=new l.Subject,this._loadedAlerts=new l.Subject,this._logger=S.Y.create("CAPIProxy"),this.pushChanges=()=>d.t$(new Error("Not implemented")),this.requestWritingExpert=()=>d.t$(new Error("Not implemented")),this._toFeedbackAlert=e=>({id:e,text:""}),this.requestDocStats=d.Uo(h.t$(new Error("Method not implemented."))),this.ping=d.Uo(h.t$(new Error("Method not implemented."))),this.enablePlagiarismSearch=d.fj((()=>p.vM((()=>this._checkingService.enablePlagiarismCheck())))),this.disablePlagiarismSearch=d.fj((()=>p.vM((()=>this._checkingService.disablePlagiarismCheck())))),this.enableWritingExpert=d.fj((()=>p.vM((()=>this._checkingService.enableWritingExpertCheck())))),this.disableWritingExpert=d.fj((()=>p.vM((()=>this._checkingService.disableWritingExpertCheck())))),this.disableAudienceAdapt=d.fj((()=>p.vM((()=>this._checkingService.disableAudienceAdapt())))),this.disableAiStudio=d.fj((()=>p.vM((()=>this._checkingService.disableAiStudio())))),this.realtimeProofitCancel=d.Uo(h.t$(new Error("Method not implemented."))),this.submitRecipients=e=>d.Uo(h.t$(new Error("Method not implemented."))),this.sendUserAction=(e,t)=>d.Uo(p.vM((()=>this._checkingService.sendUserAction(e,t)))),this.submitScoreSurveyResult=(e,t)=>d.Uo(p.vM((()=>this._checkingService.submitScoreSurveyResult(e,t)))),this.submitSurvey=e=>d.Uo(p.vM((()=>this._checkingService.submitSurvey(e)))),this.setSessionOption=e=>d.Uo(p.vM((()=>this._checkingService.setSessionOption(e)))),this.setContext=e=>d.Uo(p.vM((()=>this._checkingService.setContext(e))));const v=I.capiMessageTransformer(this._alertsTransformer),_=I.capiMessageRebaser((e=>this._textRevisionManager.getSquashedChangesSinceRevision(e)));this._subs.push(this._checkingService.checkingStatus.subscribe((e=>{switch(e){case C.H.idle:this.checkingState="idle";break;case C.H.inProgress:this.checkingState="checking";break;default:(0,b.vE)(e)}})),l.mergeStatic(this._loadedAlerts,this._checkingService.messages).pipe(l.filter(f?(0,c.W9)(T,f):T),l.map(v),l.tap(h.Vn((e=>{this._logger.error("Got non-parsable message",e)}))),l.filter(h.tO),l.map(p.MH),l.map((e=>(0,s.zG)(_(e),m.g_((()=>(this._logger.error("Message cannot be rebased, dropping",e),m.YP)),m.G)))),l.filter(m.pC),l.map(g.MH),l.mergeMap((e=>"finish"===e.kind?l.from([{kind:"before_finish"},e]):l.of(e)))).subscribe(this.events)),setTimeout((()=>{(0,s.zG)({lastFinish:this._checkingServiceState.lastFinish,lastEmoginie:this._checkingServiceState.lastEmoginie,lastTextInfo:this._checkingServiceState.lastTextInfo},o.KM(((e,t)=>t)),r.oA,r.UI(v),r.oh,(e=>e.right),(e=>(this._logger.debug("loaded messages on CAPIProxy init",e),e)),r.UI((e=>this.events.next(e))))}),0)}dispose(){this._subs.dispose(),this.events.complete()}loadAlerts(e){e.forEach((e=>{this._loadedAlerts.next({_tag:w.J8.Type.add,alert:e})}))}reportSynonymFeedback(e,t,i){throw new Error("Method not implemented.")}reportSynonymDismissed(e,t){throw new Error("Method not implemented.")}reportWritingExpertFeedback(e){throw new Error("Method not implemented.")}reportAiStudioFeedback(e){throw new Error("Method not implemented.")}reportG2Feedback(e){throw new Error("Method not implemented.")}reportTouchTypistFeedback(e){throw new Error("Method not implemented.")}reportAlertIgnore(e,t,i,n){this._checkingService.onAlertIgnored(this._toFeedbackAlert(e),t,i,n)}reportAlertAcknowledged(e,t,i,n){this._checkingService.onAlertAcknowledged(e,t,i,n)}reportAlertAccepted(e,t,i,n,r){this._checkingService.onAlertApplied(this._toFeedbackAlert(e),t,i,n,r)}reportAlertWithTranformJsonAccepted(e,t,i,n,r,o,s){this._checkingService.onAlertWithTransformJsonApplied(this._toFeedbackAlert(e),t,i,n,r,o,s)}reportAlertFeedback(e,t,i){switch(t){case f.PZ.ADD_TO_DICTIONARY:(0,s.zG)(this._getCAPIAlertById(e),h.g_((e=>this._logger.warn("Cannot add to dictionary unknown alert",e)),(e=>(0,s.zG)(e,w.DD.match({withPosition:e=>this._checkingService.onAlertSimpleFeedback(f.wQ.Id.create(e.id),f.PZ.ADD_TO_DICTIONARY,i),withTransformJSON:e=>this._checkingService.onAlertSimpleFeedback(f.wQ.Id.create(e.id),f.PZ.ADD_TO_DICTIONARY,i),withSubAlerts:e=>this._logger.warn("Cannot add to dictionary with super alert")})))));break;case f.PZ.RENDERED:case f.PZ.LOOKED:case f.PZ.HIDE:case f.PZ.WRONG_SUGGESTION:case f.PZ.OFFENSIVE_CONTENT:case f.PZ.CLOSED:case f.PZ.LIKE:case f.PZ.DISLIKE:case f.PZ.EXPANDED:case f.PZ.IGNORE_BULK_ACCEPTED:case f.PZ.USER_SATISFACTION_FEEDBACK:case f.PZ.UNLOCK:this._checkingService.onAlertSimpleFeedback(e,t,i);break;default:(0,b.vE)(t)}}reportLensFeedback(e,t){}reportEmotionFeedback(e,t){throw new Error("Method not implemented.")}reportEmotionSentenceFeedback(e,t){this._checkingService.sendEmotionSentenceFeedback({kind:t,id:e})}reportSystemFeedback(e){throw new Error("Method not implemented.")}reportAutocorrectFeedback(e){throw new Error("Method not implemented.")}reportAutocompleteFeedback(e){throw new Error("Method not implemented.")}reportAlertsBatchFeedback(e,t){throw new Error("Method not implemented.")}reportMuteFeedback(e,t,i){this._checkingService.sendMutedFeedback({kind:i,userMuteCategories:t,userMuteScope:e})}reportSnippetFeedback(e,t){this._checkingService.onSnippetFeedback({kind:t,snippetUuid:e})}reportAssistantOpenedFeedback(e){this._checkingService.onAssistantFeedback(e)}reportAutoapplyFeedback(e){this._checkingService.onAutoapplyFeedback(e)}reportDrillDownFeedback(e,t,i,n){throw new Error("Method not implemented.")}sendFeedback(e){switch(e.kind){case f._l.ASSISTANT_OPENED:return d.fj((()=>p.vM((()=>this.reportAssistantOpenedFeedback(e)))));case f.PZ.IGNORE:return d.fj((()=>p.vM((()=>{this.reportAlertIgnore(e.id,f.e3.Sidebar,e.reason,e.pnameQualifier)}))));case f.PZ.ACKNOWLEDGED:return d.fj((()=>p.vM((()=>{this.reportAlertAcknowledged(e.id,f.e3.Sidebar,e.text,e.pnameQualifier)}))));case f.PZ.ACCEPTED:return d.fj((()=>p.vM((()=>{I.isTransformJsonAlertAcceptedFeedback(e)?this.reportAlertWithTranformJsonAccepted(e.id,f.e3.Sidebar,e.alternativeIndex,e.reason,e.gapValue,e.dismissedTransformGroups,e.gbPrompt):this.reportAlertAccepted(e.id,f.e3.Sidebar,e.replacementText,e.reason,e.gbPrompt)}))));case f.PZ.ADD_TO_DICTIONARY:case f.PZ.RENDERED:case f.PZ.LOOKED:case f.PZ.CLOSED:case f.PZ.LIKE:case f.PZ.DISLIKE:case f.PZ.WRONG_SUGGESTION:case f.PZ.OFFENSIVE_CONTENT:case f.PZ.EXPANDED:case f.PZ.IGNORE_BULK_ACCEPTED:case f.PZ.USER_SATISFACTION_FEEDBACK:case f.PZ.HIDE:case f.PZ.UNLOCK:return d.fj((()=>p.vM((()=>{var t;this.reportAlertFeedback(e.id,e.kind,null!==(t=e.subtype)&&void 0!==t?t:f.e3.Inline)}))));case f.at.SYNONYM_ACCEPTED:return d.fj((()=>p.vM((()=>this.reportSynonymFeedback(e.id,e.kind,e.replacementText)))));case f.at.SYNONYM_DISMISSED:return d.fj((()=>p.vM((()=>this.reportSynonymDismissed(e.id,e.kind)))));case f.y_.EMOTION_LIKE:case f.y_.EMOTION_DISLIKE:case f.y_.EMOTION_OFFENSIVE:return d.fj((()=>p.vM((()=>this.reportEmotionFeedback(e.emotionName,e.kind)))));case f.fA.EMOTION_SENTENCE_LIKE:case f.fA.EMOTION_SENTENCE_DISLIKE:return d.fj((()=>p.vM((()=>this.reportEmotionSentenceFeedback(e.id,e.kind)))));case f.KI.RECHECK_SHOWN:return d.fj((()=>p.vM((()=>this.reportSystemFeedback(e.kind)))));case f.KX.LENS_CLOSE:case f.KX.LENS_OPEN:case f.KX.DISMISS_BY_LENS:return d.fj((()=>p.vM((()=>this.reportLensFeedback(e.lensName,e.kind)))));case f.Mw.MUTE:case f.Mw.UNMUTE:return d.fj((()=>p.vM((()=>this.reportMuteFeedback(e.userMuteScope,e.userMuteCategories,e.kind)))));case f.VD.AUTOCORRECT_ACCEPT:case f.VD.AUTOCORRECT_DISMISS:case f.VD.AUTOCORRECT_REPLACE:return d.fj((()=>p.vM((()=>this.reportAutocorrectFeedback(e.kind)))));case f._Y.COMPLETION_ACCEPTED:case f._Y.COMPLETION_IGNORED:case f._Y.COMPLETION_REJECTED:case f._Y.COMPLETION_SHOWN:return d.fj((()=>p.vM((()=>this.reportAutocompleteFeedback(e.kind)))));case f.DI.BULK_ACCEPTED:return d.fj((()=>p.vM((()=>this.reportAlertsBatchFeedback(e.alertIds,e.kind)))));case f.JE.SNIPPET_ACCEPTED:return d.fj((()=>p.vM((()=>this.reportSnippetFeedback(e.snippetUuid,e.kind)))));case f.P2.DRILLDOWN:return d.fj((()=>p.vM((()=>this.reportDrillDownFeedback(e.id,e.alternativeIndex,e.drilldownSuggestionIds,e.subtype)))));case f.Fj.WritingExpert:return d.fj((()=>p.vM((()=>this.reportWritingExpertFeedback(e.kind)))));case f.dt.AiStudio:return d.fj((()=>p.vM((()=>this.reportAiStudioFeedback(e.kind)))));case f.Q1.AUTOAPPLY_LOOKED:case f.Q1.AUTOAPPLY_REVERTED:case f.Q1.AUTOAPPLY_TRIGGERED:case f.Q1.AUTOAPPLY_ACCEPT:case f.Q1.AUTOAPPLY_AFFECTED_BY_TEXTCHANGE:return d.fj((()=>p.vM((()=>this.reportAutoapplyFeedback(e)))));case f.r0.G2_UI:return d.fj((()=>p.vM((()=>this.reportG2Feedback(e.kind)))));case f.XN.IndividualPreviewApply:case f.XN.IndividualPreviewDismiss:case f.XN.IndividualPreviewLook:case f.XN.Appeared:case f.XN.Apply:case f.XN.CardPreviewLooked:case f.XN.Revert:case f.XN.RevertLook:return d.fj((()=>p.vM((()=>this.reportTouchTypistFeedback(e.kind)))));default:return(0,b.vE)(e)}}isClosed(){throw new Error("Method not implemented.")}getText(){throw new Error("Method not implemented.")}close(e){throw new Error("Method not implemented.")}requestSynonyms(e,t){throw new Error("Method not implemented.")}requestSnippets(e){throw new Error("Method not implemented.")}enableAudienceAdapt(e){return d.fj((()=>p.vM((()=>this._checkingService.enableAudienceAdapt(e)))))}enableAiStudio(e){return d.fj((()=>p.vM((()=>this._checkingService.enableAiStudio(e)))))}sendTouchTypistCommand(e){return d.fj((()=>p.vM((()=>this._checkingService.sendTouchTypistCommand(e)))))}realtimeProofitSubmit(e){return d.Uo(h.t$(new Error("Method not implemented.")))}shortenItSubmit(e){return d.Uo(h.t$(new Error("Method not implemented.")))}sendDebugReport(e,t){return d.Uo(p.vM((()=>{this._checkingService.sendDebugReport(e,t)})))}updateContextInfo(e){return d.Uo(p.vM((()=>{this._checkingService.updateContextInfo(e)})))}published(){return d.Uo(p.vM((()=>{this._checkingService.published()})))}resetReconnectInfo(){h.t$(new Error("Method not implemented."))}sendMessage(...e){return this._checkingService.sendMessage(...e)}}const T=e=>{switch(e._tag){case w.J8.Type.add:case w.J8.Type.remove:case w.J8.Type.changed:case w.J8.Type.start:case w.J8.Type.finished:case w.J8.Type.emogenie:case w.J8.Type.textInfo:case w.J8.Type.feedback:return!0;case w.J8.Type.autocomplete:case w.J8.Type.proofitAvailability:case w.J8.Type.proofitCancelResponse:case w.J8.Type.proofitCompleted:case w.J8.Type.proofitProgress:case w.J8.Type.proofitProgressError:case w.J8.Type.proofitProgressRejected:case w.J8.Type.proofitSubmitResponse:case w.J8.Type.error:case w.J8.Type.publishedAck:case w.J8.Type.submitSurveyResultAck:case w.J8.Type.sduiAdd:case w.J8.Type.sduiUpdate:case w.J8.Type.sduiRemove:case w.J8.Type.showSurvey:case w.J8.Type.submitOtAck:case w.J8.Type.asyncCheckFinished:case w.J8.Type.setContextAck:case w.J8.Type.toggleChecksAck:case w.J8.Type.touchTypistTriggerResponse:return!1;default:return(0,b.vE)(e)}};!function(e){e.create=function(t,i,n,r,o,s){return new e(t,i.value,n,o,(e=>{const t=r.alerts.getAlertById(e);return t&&y.S.isCapiAlert(t)?h.F2(t):h.t$(new Error("Unknown alert"))}),s)},e.getLazyProxyWithState=e=>{let t=null;const i={lastStart:g.cS(),lastFinish:g.cS(),lastEmoginie:g.cS(),lastTextInfo:g.cS()};return{lazyCheckingService:(0,b.Vo)((()=>{const n=e();return t=n.messages.subscribe((e=>{e._tag===w.J8.Type.finished&&(i.lastFinish=m.G(e)),e._tag===w.J8.Type.emogenie&&(i.lastEmoginie=m.G(e)),e._tag===w.J8.Type.textInfo&&(i.lastTextInfo=m.G(e)),e._tag===w.J8.Type.start&&(i.lastStart=m.G(e))})),n})),state:{value:i,dispose:()=>t&&t.unsubscribe()}}},e.isTransformJsonAlertAcceptedFeedback=function(e){return void 0!==e.alternativeIndex},e.capiMessageTransformer=e=>t=>{switch(t._tag){case w.J8.Type.add:return(0,s.zG)(e(t.alert),h.UI((e=>({kind:"alert_received",alert:e,rev:t.alert.revision}))));case w.J8.Type.changed:return h.F2({kind:"alert_changed",alertId:t.changed.id,extraProperties:t.changed.extraProperties,transformJson:t.changed.transformJSON,muted:t.changed.muted,rev:t.changed.revision});case w.J8.Type.remove:return h.F2({kind:"alert_removed",alertId:t.removedId,hint:m.YP,mergedIn:m.YP});case w.J8.Type.start:return h.F2({kind:"session_started",defaultDocumentContext:u.R$.parseDefault(t.defaultDocumentContext),userMutedCategories:t.userMutedCategories||[],isEnterprise:t.isEnterprise,domainName:t.domainName,domainCategory:t.domainCategory,sessionUuid:t.sessionUuid,isNewSession:t.isNewSession,allowedFeatures:t.allowedFeatures,cheetahState:t.cheetahState,maxWsMessageSize:t.maxWsMessageSize});case w.J8.Type.finished:return h.F2({kind:"finish",revision:E.Q.getRevisionNumber(t.finished.revision),score:(0,s.zG)(m.ij(t.finished.generalScore),m.hX((e=>e>=0)),m.UI((e=>({errorRateScore:0,rank:e})))),lowestScore:(0,s.zG)(m.ij(t.finished.lowestGeneralScore),m.hX((e=>e>=0)),m.UI((e=>({errorRateScore:0,rank:e})))),scoreStatus:m.ij(t.finished.scoreStatus),dialect:"undefined",removed:new Set,outcomeScores:v.v0.OutcomeScores.normalize(t.finished.outcomeScores),foreign:t.finished.nonEnglishText});case w.J8.Type.emogenie:return h.F2({kind:"emotions",emotions:t.emogenieReport.emotions});case w.J8.Type.textInfo:return h.F2({kind:"text_info",data:{wordsCount:t.wordsCount,charsCount:t.charsCount,readingTime:t.readingTime,speakingTime:t.speakingTime,readabilityScore:t.readabilityScore,sessionStats:t.sessionStats,messages:m.ij(t.messages)}});case w.J8.Type.feedback:return h.F2({kind:"feedback_ack",outcomeScores:t.scores,scoreStatus:t.scoreStatus});case w.J8.Type.publishedAck:return h.F2({kind:"published_ack",survey:t.survey});case w.J8.Type.submitSurveyResultAck:return h.F2({kind:"submit_survey_result_ack"});case w.J8.Type.sduiAdd:case w.J8.Type.sduiUpdate:case w.J8.Type.sduiRemove:case w.J8.Type.asyncCheckFinished:case w.J8.Type.setContextAck:case w.J8.Type.toggleChecksAck:case w.J8.Type.touchTypistTriggerResponse:return h.F2({...t.event});default:return(0,b.vE)(t)}},e.capiMessageRebaser=e=>t=>"alert_received"===t.kind?(0,s.zG)(e(t.rev),m.UI((({deltaChanges:e,revision:t})=>({delta:e.delta,revision:t}))),m.g_((()=>m.G(t)),(e=>(0,s.zG)(_.D.transformAlert(t.alert,e),m.UI((e=>({...t,alert:e}))))))):"alert_changed"===t.kind?(0,s.zG)(e(t.rev),m.UI((({deltaChanges:e,revision:t})=>({delta:e.delta,revision:t}))),m.g_((()=>m.G(t)),(e=>(0,s.zG)(_.D.transformAlertChanged(n.AlertChangedWithRevision.unsafeToCAPI(t),e),m.UI((e=>n.AlertChangedWithRevision.unsafeFromCAPI({...t,...e}))))))):m.G(t)}(I||(I={}))},2485:(e,t,i)=>{i.d(t,{D:()=>l,a:()=>n});var n,r=i(9273),o=i(81442),s=i(6641),a=i(23031);!function(e){let t;!function(e){e.default="default",e.emogenie="emogenie",e.feedback="feedback",e.settings="settings",e.proofitRequest="proofitRequest",e.proofitReview="proofitReview",e.startupPlaceholder="startupPlaceholder"}(t=e.Type||(e.Type={})),e.isDefault=function(t){return t.type===e.Type.default},e.isEmogenie=function(t){return t.type===e.Type.emogenie},e.isFeedback=function(t){return t.type===e.Type.feedback},e.isSettings=function(t){return t.type===e.Type.settings},e.isProofitRequest=function(t){return t.type===e.Type.proofitRequest},e.isProofitReview=function(t){return t.type===e.Type.proofitReview}}(n||(n={}));class l extends s.A{constructor(e,t,i,s,l=o.V.defaultLayout){super({type:n.Type.startupPlaceholder},{type:n.Type.default}),this.browser=s,this.layout=l,this._sub=new r.Subscription,this._sub.add(t.subscribe((e=>{if(e.length>0)for(;!this.activeViewHasAlerts();)this.popActiveView()})));const c=new Set([n.Type.emogenie]);this._sub.add(i.pipe(r.debounceTime(100),r.filter(a.fQ)).subscribe((()=>{if(c.has(this._activeView.get().type))for(;this._activeView.get().type!==this._defaultView.type;)this.popActiveView()}))),this._sub.add(this._activeView.subscribe((t=>{switch(t.type){case n.Type.settings:return void e.assistantSettingsShow();case n.Type.proofitRequest:return void e.proofitRequestFormShow();default:return}})))}activeViewHasAlerts(){switch(this._activeView.get().type){case n.Type.default:case n.Type.emogenie:return!0;default:return!1}}popActiveView(){const e=this._viewHistory.pop()||this._defaultView;this._activeView.set(e)}get isHeaderNavigationEnabled(){return this._activeView.view((e=>e.type!==n.Type.feedback))}dispose(){this._sub.unsubscribe()}}},20545:(e,t,i)=>{i.d(t,{S:()=>n});var n,r=i(84766),o=i(32734),s=i(4256);!function(e){const t=e=>(0,r.F)(e).pipe((0,o.B)());e.sec5=t(s.m9(5)),e.sec2=t(s.m9(2)),e.sec1=t(s.m9(1)),e.hz4=t(s.Xd(4)),e.hz10=t(s.Xd(10)),e.hz30=t(s.Xd(30));const i=new Map;e.create=function(e){const n=i.get(e);if(n)return n;{const n=t(e);return i.set(e,n),n}}}(n||(n={}))},66414:(e,t,i)=>{i.d(t,{z:()=>b});var n,r=i(84308),o=i(36344),s=i(44071),a=i(79256),l=i(62552),c=i(64271),u=i(78837),d=i(24666),h=i(79859),p=i(59179),m=i(954),g=i(20161),f=i(32734),v=i(14527),_=i(8867);!function(e){e.isSupported="undefined"!=typeof IntersectionObserver,e.create=function(t,i){return e.isSupported?new _.y((e=>{const n=new IntersectionObserver((t=>e.next(t)),i);return n.observe(t),()=>n.unobserve(t)})):null}}(n||(n={}));var b,y=i(20545);!function(e){e.createShared=function(e,t=function(e){const t=(0,v.Cq)(e.ownerDocument&&e.ownerDocument.defaultView);return(0,s.R)(t,"resize").pipe((0,m.O)(void 0),(0,p.U)((e=>({width:t.innerWidth,height:t.innerHeight}))))}(e),i=1,_=y.S.hz30,b=1,w=500,E={width:1,height:1}){return n.isSupported?(0,a.P)((()=>{const s=Math.max(1,i),a=new l.X({width:e.clientWidth,height:e.clientHeight}),m=function(e,t,i,s,a,l,c,u){return(0,r.a)(t,i,((e,t)=>{const i=Math.max(s.width,e.width-a),n=Math.max(s.height,e.height-a),r=Math.ceil(t.width/i),o=Math.ceil(t.height/n),c=Math.sqrt(Math.min(1,l/(r*o)));return{xCells:Math.floor(r*c),yCells:Math.floor(o*c),cellWidth:Math.ceil(i/c),cellHeight:Math.ceil(n/c)}})).pipe((0,d.x)(((e,t)=>e.cellHeight===t.cellHeight&&e.cellWidth===t.cellWidth&&e.xCells===t.xCells&&e.yCells===t.yCells))).pipe((0,h.U)(c),(0,p.U)((({xCells:t,yCells:i,cellWidth:r,cellHeight:s})=>{const a=[].concat(...Array.from(Array(t),((e,t)=>Array.from(Array(i),((e,i)=>({right:t*r,bottom:i*s})))))),l=Math.max(r/u,s/u),c=l?Array.from(new Array(l),((e,t)=>t/l)):null;return a.map((({right:t,bottom:i})=>n.create(e,{rootMargin:`${-i}px 0px 0px ${-t}px`,threshold:c||void 0})||(0,o.c)()))})))}(e,a,t,E,b,w,_,s),f=m.pipe((0,g.w)((e=>(0,c.T)(...e))),(0,p.U)((e=>e[e.length-1].boundingClientRect)),(0,d.x)(((e,t)=>e.top===t.top&&e.left===t.left&&e.width===t.width&&e.height===t.height))),v=f.subscribe((e=>{a.next({width:e.width,height:e.height})}));return(0,u.g)((()=>v),(e=>f))})).pipe((0,f.B)()):null}}(b||(b={}))},9358:(e,t,i)=>{i.d(t,{BJ:()=>s,Eq:()=>l,U_:()=>c,gk:()=>u,lH:()=>r,oJ:()=>o,op:()=>n,wJ:()=>a});const n=2147483647,r=n-1,o=n-2,s=n-3,a=n-5,l=n-6,c=a,u=1350},52351:(e,t,i)=>{i.d(t,{Cv:()=>s,E9:()=>n,Ir:()=>o,p8:()=>r});var n,r,o,s,a=i(48830);!function(e){e.equals=function(e,t){return(0,a.M$)(e.left,t.left)&&(0,a.M$)(e.top,t.top)},e.fromCartesian=function({x:e,y:t}){return{top:t,left:e}},e.toCartesian=function({top:e,left:t}){return{x:t,y:e}},e.zero={top:0,left:0},e.minus=function(e,t){return{top:e.top-t.top,left:e.left-t.left}},e.plus=function(e,t){return{top:e.top+t.top,left:e.left+t.left}},e.ceil=function(e){return{left:Math.ceil(e.left),top:Math.ceil(e.top)}},e.floor=function(e){return{left:Math.floor(e.left),top:Math.floor(e.top)}},e.create=function(e){return{top:e.top,left:e.left}},e.l1Distance=function(e,t){return Math.abs(e.top-t.top)+Math.abs(e.left-t.left)}}(n||(n={})),function(e){function t(e){return{top:e.top,left:e.left}}e.create=t,e.fromClientPoint=function(e,i,n){return t({top:e.top-i.top+n.top,left:e.left-i.left+n.left})},e.zero={top:0,left:0}}(r||(r={})),function(e){function t(e){return{top:e.top,left:e.left}}e.create=t,e.fromOffsetPoint=function(e,i,n){return t({top:e.top+i.top-n.top,left:e.left+i.left-n.left})},e.fromPage=function(e,i){return t({top:e.top-i.top,left:e.left-i.left})}}(o||(o={})),function(e){function t(e){return{top:e.top,left:e.left}}e.create=t,e.getHighlightsPosition=function(e,i,n,r={top:0,left:0}){return t({top:e.top+i.top+n.top+r.top,left:e.left+i.left+n.left+r.left})},e.fromClient=function(e,i){return t({top:e.top+i.top,left:e.left+i.left})},e.fromOffset=function(e,t,i){return{top:e.top+t.top-i.top,left:e.left+t.left-i.left}}}(s||(s={}))},27853:(e,t,i)=>{i.d(t,{$u:()=>n,D1:()=>a,Pf:()=>s,UL:()=>r,Wm:()=>o});var n,r,o,s,a,l=i(48830),c=i(52351);!function(e){e.create=function(e){return{width:e.width,height:e.height}}}(n||(n={})),function(e){function t(e,t){const i=e.left<=t.left?e:t,n=i===e?t:e,r=e.top<=t.top?e:t,o=r===e?t:e;return i.left+i.width>=n.left&&r.top+r.height>=o.top}e.union=function(e){return t=>t.slice(1).reduce(((t,i)=>{const n=Math.min(i.top,t.top),r=Math.min(i.left,t.left),o=Math.max(t.left+t.width,i.left+i.width)-r,s=Math.max(t.top+t.height,i.top+i.height)-n;return e({top:n,left:r,width:o,height:s})}),t[0])},e.getIntersection=function(e,i){if(!t(e,i))return null;const n=e.left+e.width,r=e.top+e.height,o=i.left+i.width,s=i.top+i.height,a=Math.max(e.left,i.left),l=Math.max(e.top,i.top);return{left:a,top:l,width:Math.min(n,o)-a,height:Math.min(r,s)-l}},e.contains=function(e,t){return e.left>=t.left&&e.left<=t.left+t.width&&e.top>=t.top&&e.top<=t.top+t.height},e.doesRectContain=function(e,t){return t.left>=e.left&&t.left+t.width<=e.left+e.width&&t.top>=e.top&&t.top+t.height<=e.top+e.height},e.intersects=t,e.intersectsStrict=function(e,t){const i=e.left<=t.left?e:t,n=i===e?t:e,r=e.top<=t.top?e:t,o=r===e?t:e;return i.left+i.width>n.left&&r.top+r.height>o.top},e.setPosition=function(e,t){const i=n.create(t);return Object.assign({},e,n.create(t),{right:e.left+i.width,bottom:e.top+i.height})},e.area=function(e){return e.width*e.height},e.isEmpty=function(e){return 0===e.width&&0===e.height},e.shift=function(e,t){const i=c.E9.plus(e,t);return{...e,...i}},e.widen=function(e,t){return{...e,left:e.left-t,width:e.width+2*t}},e.equals=function(e,t,i){return(0,l.M$)(e.left,t.left,i)&&(0,l.M$)(e.top,t.top,i)&&(0,l.M$)(e.width,t.width,i)&&(0,l.M$)(e.height,t.height,i)},e.verticalOverlap=function(e,t){const i=e.top<=t.top?e:t,n=i===e?t:e,r=i.top+i.height-n.top;return r<0?0:r>n.height?1:r/Math.min(n.height,i.height)},e.midlineHorizontal=function(e){return{...e,top:e.top+e.height/2,height:0}},e.midlineVertical=function(e){return{...e,left:e.left+e.width/2,width:0}}}(r||(r={})),function(e){e.create=function(e){return{...e,kind:"offsetPoint"}},e.topLeftPoint=function({top:e,left:t}){return{kind:"offsetPoint",top:e,left:t}}}(o||(o={})),function(e){e.create=function(e){return{kind:"clientPoint",top:e.top,left:e.left,bottom:(null==e?void 0:e.bottom)||e.top+e.height,right:(null==e?void 0:e.right)||e.left+e.width,width:e.width,height:e.height}},e.empty={top:0,left:0,bottom:0,right:0,width:0,height:0,kind:"clientPoint"}}(s||(s={})),function(e){e.create=function(e){return e}}(a||(a={}))},92244:(e,t,i)=>{if(i.d(t,{Bi:()=>w,E6:()=>p,Jj:()=>l,Me:()=>a,Qf:()=>y,XQ:()=>u,Yd:()=>d,a9:()=>g,bp:()=>h,f0:()=>b,is:()=>m,kW:()=>v,o:()=>c,wr:()=>f}),6168!=i.j)var n=i(14527);const r=new Set(["absolute","relative","fixed","sticky"]),o=new Set(["strict","content","layout","paint"]),s=new Set(["flex","inline-flex"]);function a(e){const t=e.ownerDocument;if(t)return t;throw new Error("target does not have ownerDocument")}function l(e){const t=a(e).defaultView;if(t)return t;throw new Error("active document is detached from a window")}function c(e){return l(e).getComputedStyle(e)}function u(e){return r.has(c(e).position)}function d(e,t){const i=r.has(t.position);return!i&&null!==t.zIndex&&"auto"!==t.zIndex&&e.parentElement?s.has(c(e.parentElement).display):i}function h(e){const t=a(e).body;if(e===t)throw new Error("target is body");let i=e;do{if(i=i.parentElement,i&&u(i))return i}while(null!==i&&i!==t);return i||t}function p(e,t){var i,r,o,s;const l=a(e).body;if(e===l)throw new Error("target is body");const c=(0,n.Cq)(l.parentElement);let u=e;do{if(u=null!==(s=null!==(r=null!==(i=u.assignedSlot)&&void 0!==i?i:u.parentElement)&&void 0!==r?r:null===(o=u.getRootNode())||void 0===o?void 0:o.host)&&void 0!==s?s:null,u&&t(u))return u}while(null!==u&&u!==c);return u||c}function m(e){return p(e,(e=>{return u(e)||(t=e,o.has(c(t).contain));var t}))}function g(e){return function(e){const t=c(e);return"auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowY||"scroll"===t.overflowY}(e)||function(e){const t=c(e);return"auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowX||"scroll"===t.overflowX}(e)}function f(e,t){for(let i=e;null!=i;i=i.parentElement)if(t(i))return i;return null}function v(e){const t=e.ownerDocument,i=t&&t.defaultView;if(!t||!i)return;const n=t.body.scrollLeft,r=t.body.scrollTop,o=i.scrollY,s=i.scrollX;e.focus(),o===i.scrollY&&s===i.scrollX||i.scroll(s,o),r!==t.body.scrollTop&&(t.body.scrollTop=r),n!==t.body.scrollLeft&&(t.body.scrollLeft=n)}const _=e=>e?1/e:1,b=(e,t)=>{if(!e)return;const i=y(self.getComputedStyle(e));if(!i)return;const n=_(Number(i.x)),r=_(Number(i.y));return{transform:`translate(${t.left*(n-1)}px, ${t.top*(r-1)}px) scale(${n}, ${r})`,transformOrigin:e.style.transformOrigin}};function y(e){if(e.transform&&"none"!==e.transform){const t=/scale\(([\d.]+)(?:, ([\d.]))*\)|matrix\(([\d.]+), [\d.]+, [\d.]+, ([\d.]+), [\d.]+, [\d.]+\)/.exec(e.transform);if(t){const[e,i,n,r,o]=t;return{x:i||r,y:n||o||i}}}}function w(e){try{const t=new DOMMatrixReadOnly(e.transform);return{x:t.e,y:t.f}}catch(e){return}}},26590:(e,t,i)=>{i.d(t,{SR:()=>o,Vw:()=>r,eE:()=>a,fy:()=>n,rS:()=>s});const n=20,r=200,o=3;var s,a;!function(e){e.NOT_AVAILABLE="not_available",e.NOT_AVAILABLE_QUOTA_ERROR="not_available_quota_error",e.NO_FREE_TRIALS_LEFT="no_free_trials_left",e.NOT_ENOUGH_WORDS="not_enough_words",e.TOO_MANY_WORDS="too_many_words",e.CONFLICTING_REQUEST="conflicting_request",e.CHECKING_INITIAL_AVAILABILITY="checking_initial_availability",e.UNSUPPORTED_LANGUAGE="unsupported_language"}(s||(s={})),function(e){e.INITIAL="initial",e.IDLE="idle",e.PREPARING="preparing",e.PRE_SUBMIT="pre_submit",e.ACCEPTED="accepted",e.IN_PROGRESS="in_progress",e.COMPLETED="completed",e.REJECTED="rejected",e.ERROR="error",e.PRE_CANCEL="pre_cancel",e.CANCELED="canceled",e.REVIEWING="reviewing"}(a||(a={}))},74823:(e,t,i)=>{i.r(t),i.d(t,{ProofitFeature:()=>D,ProofitGmailInProgressRequestTracker:()=>q,ProofitGmailIntegrationForComposeWindow:()=>H,ProofitGmailIntegrationForThreads:()=>G,ProofitTextReplacement:()=>F,ProofitViewInjector:()=>U.E});var n=i(84308),r=i(64271),o=i(84714),s=i(93440),a=i(8867),l=i(84766),c=i(59179),u=i(90572),d=i(24666),h=i(78129),p=i(98189),m=i(14969),g=i(20161),f=i(29479),v=i(29416),_=i(10883),b=i(84178),y=i(39256),w=i(44045),E=i(79859),S=i(19830),C=i(13391),I=i(8261),T=i(66061),P=i(2485),A=i(60108),k=i(20545),R=i(26590),M=i(4256),x=i(78542),L=i(94454);class D{constructor(e,t,i,l,b,y,w,E,S,T,P,A,k,W,O){this.layout=e,this._checkingStatus=t,this._geometryInvalidated=l,this._textObserver=b,this._gnar=y,this._state=w,this._felog=E,this._docId=S,this._submitRequestToApi=T,this._cancelRequestToApi=P,this._reconnectSessionWithApi=A,this._actions=k,this.textReplacement=W,this.isUsingSDUI=O,this._subs=[],this._textChangesDuringReviewSubscription=null,this._calculateHighlightsRectsSubscription=null,this._available=C.h.create("unknown"),this._isEnglish=C.h.create("unknown"),this.inProgressTabMounted=C.h.create(!1),this._conflictingInProgressTabMounted=C.h.create(!1),this.quotaRemaining=C.h.create(0),this.requestInfo=C.h.create(D.INITIAL_REQUEST_INFO),this.requestDisabledInfo=C.h.create(null),this._log=x.Y.create(`Proofit - docId: ${(0,L.Of)(S)}`),this.turnaroundTime=this._state.view((e=>{var t,i;return null!==(i=null===(t=e.dynamicConfig.proofit)||void 0===t?void 0:t.turnaroundTime)&&void 0!==i?i:60})),this.layoutCreated=this.layout.pipe((0,c.U)((e=>null!==e))),this._quotaResetDate=this._state.view((({dapi:{billing_subscription_plan_period:e,billing_subscription_renewal_date:t}})=>({billing_subscription_plan_period:e,billing_subscription_renewal_date:t}))).view((e=>{var t;return"MONTHLY"===e.billing_subscription_plan_period&&null!==(t=e.billing_subscription_renewal_date)&&void 0!==t?t:null})),this.disableHowItWorksInfo=this._state.view((e=>Boolean(e.page.disableProofitHowItWorksInfo))),this._subs.push(this.layout.subscribe((e=>{e&&(this._subs.push(e.proofitInProgressTabLayout.mounted.subscribe((e=>this.inProgressTabMounted.set(e)))),this._subs.push(e.proofitInProgressTabLayout.conflictingTabMounted.subscribe((e=>this._conflictingInProgressTabMounted.set(e)))))}))),this._subs.push((0,n.a)([this._available,this._isEnglish,this.quotaRemaining,this._quotaResetDate,i,this._conflictingInProgressTabMounted,this.requestInfo.view("status")]).pipe((0,c.U)((([e,t,i,n,r,o,s])=>s===R.eE.REVIEWING?null:s===R.eE.INITIAL?{reason:R.rS.CHECKING_INITIAL_AVAILABILITY}:0===i?{reason:R.rS.NO_FREE_TRIALS_LEFT,meta:{quotaResetDate:n}}:!1===t?{reason:R.rS.UNSUPPORTED_LANGUAGE}:i<0?{reason:R.rS.NOT_AVAILABLE_QUOTA_ERROR}:!1===e?{reason:R.rS.NOT_AVAILABLE}:o?{reason:R.rS.CONFLICTING_REQUEST}:r<R.fy?{reason:R.rS.NOT_ENOUGH_WORDS,meta:{wordsCount:r}}:r>R.Vw?{reason:R.rS.TOO_MANY_WORDS,meta:{wordsCount:r}}:null))).subscribe((e=>this.requestDisabledInfo.set(e)))),this._subs.push(this.requestDisabledInfo.pipe((0,c.U)((e=>{var t;return null!==(t=null==e?void 0:e.reason)&&void 0!==t?t:null})),(0,u.h)((e=>e!==R.rS.CHECKING_INITIAL_AVAILABILITY)),(0,d.x)()).subscribe((e=>{null===e?this._gnar.proofitButtonEnabled():this._gnar.proofitButtonDisabled(e)}))),this._subs.push(this.requestInfo.pipe((0,h.G)()).subscribe((([e,t])=>{this._log.trace("Request info changes (previous vs. new):",{previousRequestInfo:e,newRequestInfo:t})}))),this._subs.push((0,n.a)([this._isEnglish,this._available]).pipe((0,p.n)((([e,t])=>"unknown"===e||"unknown"===t)),(0,m.P)()).subscribe((e=>{this.requestInfo.view("status").get()===R.eE.INITIAL&&this.requestInfo.modify((e=>({...e,status:R.eE.IDLE})))}))),this.startedThenStoppedTyping=this._textObserver.contentChanges.async.pipe((0,g.w)((e=>(0,r.T)((0,o.of)(e.changes.length>0),(0,s.H)((0,M.m9)(2)).pipe((0,f.h)(!1))))),(0,h.G)(),(0,c.U)((([e,t])=>!0===e&&!1===t))),this._subs.push(new a.y((e=>{const t=()=>e.next(void 0);return(0,I.OB)().message.on("bgSW-shutdown",t),()=>(0,I.OB)().message.off("bgSW-shutdown",t)})).pipe((0,v.b)(M.E0),(0,_.M)(this.requestInfo.view((e=>e.status))),(0,u.h)((([,e])=>e===R.eE.IN_PROGRESS))).subscribe((()=>this._reconnectSessionWithApi())))}onAvailabilityData(e){this._log.trace("Availability response received:",e),this._available.set(e.quota>=0&&e.available),this.quotaRemaining.set(e.quota),e.quota<0&&this._felog.proofit.availabilityQuotaError(this._getDataForErrorTracking())}setIsEnglish(e){this._isEnglish.set(e)}onSubmitResponse(e){this._log.trace("Submit response received:",e),"error"===e.status?(this.requestInfo.set({...D.IDLE_REQUEST_INFO,status:R.eE.ERROR}),this._felog.proofit.submitResponseError(this._getDataForErrorTracking())):"accepted"===e.status&&this.requestInfo.modify((e=>({...e,status:R.eE.ACCEPTED})))}onCancelResponse(e){this._log.trace("Cancel response received:",e),this.quotaRemaining.set(e.quota),this.requestInfo.set({...D.IDLE_REQUEST_INFO,status:R.eE.CANCELED})}onProgress(e){this._log.trace("Request in progress message received:",e);const t=this.requestInfo.get().status;t!==R.eE.ACCEPTED&&t!==R.eE.IN_PROGRESS||(this.requestInfo.modify((t=>({...t,status:R.eE.IN_PROGRESS,slicesChecked:e.checked,totalSlices:e.total,suggestionsMade:e.changesNumber,activeReviewers:e.activeReviewers}))),t===R.eE.ACCEPTED&&this._subs.push((0,l.F)(M.E0).pipe((0,b.q)(this.turnaroundTime.get()+1),(0,_.M)(this.requestInfo.view("status")),(0,y.o)((([e,t])=>t===R.eE.IN_PROGRESS)),(0,c.U)((([e,t])=>this.turnaroundTime.get()-e))).subscribe((e=>this.requestInfo.modify((t=>({...t,secondsRemaining:e})))))))}onCompleted(e){const t=this.requestInfo.get().timeStarted;if(t){const e=(Date.now()-t)/1e3;this._gnar.proofitOrderTurnaroundTimeInSeconds(e)}this._log.trace("Request completed message received:",e),this.requestInfo.modify((t=>({...t,status:R.eE.COMPLETED,slicesChecked:e.checked,totalSlices:e.total,suggestionsMade:e.changesNumber,textChanges:e.textChanges,timeStarted:void 0})))}onError(e){this._log.trace("Request error message received:",e),this.requestInfo.set({...D.IDLE_REQUEST_INFO,status:R.eE.ERROR}),this._felog.proofit.progressError(this._getDataForErrorTracking(e.reason))}onRejected(e){this._log.trace("Request rejected message received:",e),this.requestInfo.set({...D.IDLE_REQUEST_INFO,status:R.eE.REJECTED}),this._felog.proofit.progressRejected(this._getDataForErrorTracking(e.reason))}onCAPISessionStart(){this.requestInfo.get().status!==R.eE.ACCEPTED&&this.requestInfo.get().status!==R.eE.IN_PROGRESS||(this._log.trace('Submitting request again (with "reconnect: true")'),this._submitRequestToApi(!0))}resetRequest(){var e;this._log.trace("Resetting request."),null===(e=this._calculateHighlightsRectsSubscription)||void 0===e||e.unsubscribe(),this.requestInfo.set(D.IDLE_REQUEST_INFO)}submitRequest(){this._log.trace("Submitting request."),this._actions.sentProofitRequest();const e=Date.now();this.requestInfo.set({...D.IDLE_REQUEST_INFO,status:R.eE.PREPARING});const t=this._checkingStatus.pipe((0,v.b)(300),(0,u.h)((e=>e===A.H.idle)));(0,l.F)(100).pipe((0,w.R)(t)).subscribe({complete:()=>{this._submitRequestToApi(!1),this.requestInfo.set({...D.IDLE_REQUEST_INFO,status:R.eE.PRE_SUBMIT,timeStarted:e})}})}cancelRequest(){this._log.trace("Canceling request."),this._gnar.proofitOrderCanceled(),this._cancelRequestToApi(),this.requestInfo.modify((e=>({...e,timeStarted:void 0,status:R.eE.PRE_CANCEL})))}async reviewRequest(){var e,t;this._log.trace("Reviewing request."),this._gnar.proofitOrderReviewed(),this.requestInfo.modify((e=>({...e,status:R.eE.REVIEWING}))),null===(e=this._textChangesDuringReviewSubscription)||void 0===e||e.unsubscribe();const i=await this.textReplacement.applyTextChanges(this.requestInfo.get().textChanges);this._calculateHighlightsRects(i),null===(t=this._calculateHighlightsRectsSubscription)||void 0===t||t.unsubscribe(),this._calculateHighlightsRectsSubscription=this._geometryInvalidated.pipe((0,E.U)(k.S.hz10),(0,_.M)(this.requestInfo.view("highlights"))).subscribe((([e,t])=>{this._calculateHighlightsRects(t)})),this._subs.push(this._calculateHighlightsRectsSubscription),this._textChangesDuringReviewSubscription=this._textObserver.contentChanges.immediate.pipe((0,S.u)((0,s.H)(1e3)),(0,u.h)((e=>e.changes.length>0)),(0,m.P)()).subscribe((()=>this.resetRequest())),this._subs.push(this._textChangesDuringReviewSubscription)}_calculateHighlightsRects(e){const t=this.textReplacement.calculateHighlightsRects(e);this.requestInfo.modify((e=>({...e,highlights:t})))}dialogCaller(){return this._isInReview()?{type:T.WT.proofitReview}:{type:T.WT.proofitRequest}}assistantViewType(){return this._isInReview()?P.a.Type.proofitReview:P.a.Type.proofitRequest}onDisableHowItWorksInfo(e){e?this._actions.disableProofitHowItWorksInfo():this._actions.enableProofitHowItWorksInfo()}dispose(){this._subs.forEach((e=>e.unsubscribe()))}_getDataForErrorTracking(e){var t,i;const n=this.requestInfo.get();return{reason:null!=e?e:null,featureState:{available:this._available.get(),quotaRemaining:this.quotaRemaining.get(),isEnglish:this._isEnglish.get(),requestInfo:{status:n.status,slicesChecked:n.slicesChecked,totalSlices:n.totalSlices,suggestionsMade:n.suggestionsMade},requestDisabledReason:null!==(i=null===(t=this.requestDisabledInfo.get())||void 0===t?void 0:t.reason)&&void 0!==i?i:null,docId:(0,L.Of)(this._docId)}}}_isInReview(){return this.requestInfo.get().status===R.eE.REVIEWING}}D.INITIAL_REQUEST_INFO={status:R.eE.INITIAL,slicesChecked:0,totalSlices:0,suggestionsMade:0,textChanges:[],highlights:[],activeReviewers:0},D.IDLE_REQUEST_INFO={...D.INITIAL_REQUEST_INFO,status:R.eE.IDLE};var W=i(36807),O=i(33632),N=i(27853);class F{constructor(e,t,i,n,r){this._getCurrentTextMap=t,this._geometryProvider=i,this._geometryLayout=n,this._replacementService=r,this._log=x.Y.create(`ProofitTextReplacement - docId: ${(0,L.Of)(e)}`)}calculateHighlightsRects(e){const t=e.map((e=>{const t=this._geometryProvider.create(e.range,this._getCurrentTextMap()),i=t?this._geometryProvider.getClientRects(t):[],n=(i?Array.from(i):[]).map((e=>N.UL.setPosition(this._geometryLayout.getCurrentConversionContext().clientToRelative(e),e)));return{...e,rects:n}}));return this._log.trace("Highlights rects calculated:",t),t}async applyTextChanges(e){var t;this._log.trace("Applying text changes:",e),this._log.trace("Text before changes:",`"${this._getCurrentTextMap().getPlainText()}"`);let i=0,n=[];for(const r of e){const e=r.context.s+i,o=r.context.e+i,s=await this._applyTextChangesToSlice(e,o,new W.i(null===(t=r.alternatives)||void 0===t?void 0:t[0]));i+=s.indexRebase,n=n.concat(s.highlights)}return this._log.trace("Text after changes:",`"${this._getCurrentTextMap().getPlainText()}"`),n}async _applyTextChangesToSlice(e,t,i){this._log.trace("Applying text changes to slice within the range:",`[${e}, ${t}]`),this._log.trace("Text in slice before changes:",this._getCurrentTextMap().getPlainText().slice(e,t+1));let n=e-1,r=0,o=null;const s=[];for(let e=0;e<i.ops.length;e++){const t=i.ops[e],a=n+1;let l=null,c=null,u=null;if(O.s.isRetain(t))n+=t.retain;else if(O.s.isInsertString(t)){const s=i.ops[e+1];s&&O.s.isDelete(s)?o=t:(l=a,c="",u=t.insert,n+=u.length,r+=u.length)}else O.s.isDelete(t)&&(l=a+t.delete,c=this._getCurrentTextMap().getPlainText().slice(a,a+t.delete),o?(u=o.insert,o=null):u="",n+=u.length,r=r+u.length-t.delete);if(null!==l&&null!==c&&null!==u){await this._replacementService.performReplacement({pos:{start:a,end:l},value:u});const e={start:a,end:a+u.length};if(0===u.length){const t=this._getCurrentTextMap().getPlainText();" "===t[e.end]?e.end=e.end+1:" "===t[e.start-1]?e.start=e.start-1:t[e.end]?e.end=e.end+1:t[e.start-1]&&(e.start=e.start-1)}s.push({range:e,originalText:c,rects:[]})}}return this._log.trace("Text in slice after changes:",this._getCurrentTextMap().getPlainText().slice(0===e?e:e+r,t+r+1)),{indexRebase:r,highlights:s}}}class q{constructor(){this._inProgressId=C.h.create(null)}currentId(){return this._inProgressId.get()}sameRequestInProgress(e){return this._inProgressId.view((t=>Boolean(t)&&t===e))}differentRequestInProgress(e){return this._inProgressId.view((t=>Boolean(t)&&t!==e))}markInProgress(e){this._inProgressId.set(e)}markNotInProgress(){this._inProgressId.set(null)}}q.MESSAGE_ID=0,q.generateId=()=>{const e=`proofit-in-progress-${q.MESSAGE_ID}`;return q.MESSAGE_ID+=1,e};var z=i(66414),j=i(9358);class H{constructor(e,t,i){this._targetTextField=e,this._fieldContainer=t,this._inProgressRequestTracker=i,this._messageId=q.generateId()}getProofitLayout(){var e,t,i,n,r,o,s,a,l,c,u,d,h,p,m,g,f,v,_,b,y;const w=null===(i=null===(t=null===(e=this._targetTextField.closest("table"))||void 0===e?void 0:e.closest("table:not(:scope)"))||void 0===t?void 0:t.querySelector('[command="Files"]'))||void 0===i?void 0:i.closest("table"),E=null==w?void 0:w.querySelector("tr td:first-of-type");this._composeWindow=this._targetTextField.closest('[role="dialog"]'),this._composeWindowContent=null===(r=null===(n=this._composeWindow)||void 0===n?void 0:n.querySelector(":scope > .nH > .aaZ"))||void 0===r?void 0:r.parentElement,this._composeWindowLabel=null===(o=this._composeWindow)||void 0===o?void 0:o.querySelector(":scope > .nH.Hy.aXJ");const S=null===(a=null===(s=this._composeWindow)||void 0===s?void 0:s.querySelector('input[name="draft"]'))||void 0===a?void 0:a.value,C=S?null===(l=this._targetTextField.ownerDocument.querySelector(`[data-standalone-draft-id="${S}"]`))||void 0===l?void 0:l.closest("tr"):null;return this._draftItemLabel=null==C?void 0:C.querySelector(":scope > td.yX.xY > div.yW > span.bA4 > span.yP.boq"),this._fullscreenContainer=null===(c=this._composeWindow)||void 0===c?void 0:c.closest(".aVN"),this._fullscreenOverlay=null===(u=this._fullscreenContainer)||void 0===u?void 0:u.closest(".aSs"),this._minimizedComposeWindowContainerWrapperList=this._targetTextField.ownerDocument.querySelector(".dw > div > .nH > .nH > .no"),this._minimizedComposeWindowContainerWrapperListParent=null===(m=null===(p=null===(h=null===(d=this._minimizedComposeWindowContainerWrapperList)||void 0===d?void 0:d.parentElement)||void 0===h?void 0:h.parentElement)||void 0===p?void 0:p.parentElement)||void 0===m?void 0:m.parentElement,this._minimizedComposeWindowContainerWrapper=this._fullscreenContainer?Array.from(null!==(f=null===(g=this._minimizedComposeWindowContainerWrapperList)||void 0===g?void 0:g.querySelectorAll(":scope > .nH.nn"))&&void 0!==f?f:[]).find((e=>{const t=e.querySelector(":scope > .no > .nH.nn > .AD > .Hd");return Boolean(t&&!t.hasChildNodes())})):null===(b=null===(_=null===(v=this._composeWindow)||void 0===v?void 0:v.closest(".nH.nn"))||void 0===_?void 0:_.parentElement)||void 0===b?void 0:b.closest(".nH.nn"),this._minimizedComposeWindowContainer=null===(y=this._minimizedComposeWindowContainerWrapper)||void 0===y?void 0:y.querySelector(":scope > .no > .nH.nn"),this._hubspotSalesExtensionSidebarWidget=this._targetTextField.ownerDocument.querySelector(".hubspot.hubspot-sales-sidebar-tab-container"),w&&E&&this._composeWindow&&this._composeWindowContent&&this._minimizedComposeWindowContainerWrapperList&&this._minimizedComposeWindowContainerWrapper&&this._minimizedComposeWindowContainer?{proofitButtonLayout:{sibling:E,popupStyle:{zIndex:1}},proofitInProgressTabLayout:{container:this._minimizedComposeWindowContainer,mounted:this._inProgressRequestTracker.sameRequestInProgress(this._messageId),onMount:()=>this._onMountInProgressTab(),onUnmount:()=>this._onUnmountInProgressTab(),style:{position:"absolute",bottom:0,right:0,visibility:"visible"},conflictingTabMounted:this._inProgressRequestTracker.differentRequestInProgress(this._messageId),shouldLimitInteraction:Boolean(this._fullscreenContainer)},proofitHighlightsLayout:{container:this._fieldContainer,style:{position:"absolute",zIndex:j.wJ}},proofitInProgressDraftItemLayout:{clientRect:!this._fullscreenContainer&&C?z.z.createShared(C):null,style:{position:"fixed",backgroundColor:C?getComputedStyle(C).backgroundColor:"rgba(242,245,245,0.8)",opacity:.5}}}:null}_onMountInProgressTab(){var e,t;if(this._composeWindow&&this._composeWindowContent&&this._minimizedComposeWindowContainerWrapperList&&this._minimizedComposeWindowContainerWrapper&&this._minimizedComposeWindowContainer){if(this._inProgressRequestTracker.currentId()===this._messageId)return;if(this._fullscreenContainer){if(this._minimizedComposeWindowContainerWrapper.style.display="block",this._fullscreenContainer.style.display="none",this._fullscreenOverlay){const t=getComputedStyle(this._fullscreenOverlay),i=this._targetTextField.ownerDocument.createElement("div");i.style.backgroundColor=t.backgroundColor,i.style.height="100%",i.style.width="100%",i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.zIndex=t.zIndex,i.setAttribute("data-grammarly-proofit-in-progress-overlay","true"),this._fullscreenOverlay.style.visibility="hidden",null===(e=this._minimizedComposeWindowContainerWrapperListParent)||void 0===e||e.insertAdjacentElement("beforebegin",i),this._hubspotSalesExtensionSidebarWidget&&(this._hubspotSalesExtensionSidebarWidget.style.visibility="hidden")}null===(t=this._minimizedComposeWindowContainerWrapperList)||void 0===t||t.querySelectorAll(":scope > .nH.nn").forEach((e=>{e!==this._minimizedComposeWindowContainerWrapper&&(e.style.opacity="0.5",e.style.pointerEvents="none")}))}else this._composeWindowLabel&&(this._composeWindowLabel.style.display="none");this._draftItemLabel&&(this._draftItemLabel.innerHTML="Expert review in progress"),this._minimizedComposeWindowContainerWrapper.style.height="100vh",this._minimizedComposeWindowContainer.style.height="100vh",this._minimizedComposeWindowContainer.style.zIndex="2",this._composeWindowContent.style.display="none",this._composeWindow.setAttribute("data-grammarly-proofit-in-progress-compose-window-container-width",this._minimizedComposeWindowContainer.style.width),this._composeWindow.setAttribute("data-grammarly-proofit-in-progress-compose-window-container-wrapper-width",this._minimizedComposeWindowContainerWrapper.style.width),this._minimizedComposeWindowContainer.style.width="260px",this._minimizedComposeWindowContainerWrapper.style.width="265px",this._inProgressRequestTracker.markInProgress(this._messageId)}}_onUnmountInProgressTab(){var e;if(this._composeWindow&&this._composeWindowContent&&this._minimizedComposeWindowContainerWrapperList&&this._minimizedComposeWindowContainerWrapper&&this._minimizedComposeWindowContainer){if(this._inProgressRequestTracker.currentId()!==this._messageId)return;this._fullscreenContainer?(this._minimizedComposeWindowContainerWrapper.style.display="none",this._fullscreenContainer.style.display="block",this._fullscreenOverlay&&(this._fullscreenOverlay.style.visibility="inherit",null===(e=this._targetTextField.ownerDocument.body.querySelector('div[data-grammarly-proofit-in-progress-overlay="true"]'))||void 0===e||e.remove()),this._minimizedComposeWindowContainerWrapperList.querySelectorAll(":scope > .nH.nn").forEach((e=>{e.style.opacity="initial",e.style.pointerEvents="initial"})),this._hubspotSalesExtensionSidebarWidget&&(this._hubspotSalesExtensionSidebarWidget.style.visibility="visible")):this._composeWindowLabel&&(this._composeWindowLabel.style.display="block"),this._draftItemLabel&&(this._draftItemLabel.innerHTML="Draft"),this._minimizedComposeWindowContainer.style.zIndex="auto",this._composeWindowContent.style.display="block";const t=this._composeWindow.getAttribute("data-grammarly-proofit-in-progress-compose-window-container-width"),i=this._composeWindow.getAttribute("data-grammarly-proofit-in-progress-compose-window-container-wrapper-width");t&&i&&(this._minimizedComposeWindowContainer.style.width=t,this._minimizedComposeWindowContainerWrapper.style.width=i),this._composeWindow.removeAttribute("data-grammarly-proofit-in-progress-compose-window-container-width"),this._composeWindow.removeAttribute("data-grammarly-proofit-in-progress-compose-window-container-wrapper-width"),this._inProgressRequestTracker.markNotInProgress(),this._targetTextField.focus()}}}class G{constructor(e,t,i){this._targetTextField=e,this._fieldContainer=t,this._inProgressRequestTracker=i,this._progressMessageElement=null,this._hideComposeTab=e=>{var t;e.setAttribute("data-grammarly-proofit-in-progress-compose-window-wrapper-display",null!==(t=e.style.display)&&void 0!==t?t:"inherit"),e.style.display="none"},this._showComposeTab=e=>{var t;const i="data-grammarly-proofit-in-progress-compose-window-wrapper-display",n=null!==(t=e.getAttribute(i))&&void 0!==t?t:"";e.style.display=n,e.removeAttribute(i)},this._messageId=q.generateId()}getProofitLayout(){var e,t,i,n,r,o,s,a,l,c;const u=null===(i=null===(t=null===(e=this._targetTextField.closest("table"))||void 0===e?void 0:e.closest("table:not(:scope)"))||void 0===t?void 0:t.querySelector('[command="Files"]'))||void 0===i?void 0:i.closest("table"),d=null==u?void 0:u.querySelector("tr td:first-of-type");return this._composeWindow=this._targetTextField.closest('[role="region"]'),this._composeWindowContent=null===(n=this._composeWindow)||void 0===n?void 0:n.querySelector(":scope > table.HM > tbody > tr > td.I5"),this._fullscreenOverlay=document.querySelector(".aSs"),this._minimizedComposeWindowContainerWrapperList=this._targetTextField.ownerDocument.querySelector(".dw > div > .nH > .nH > .no"),this._minimizedComposeWindowContainerWrapperListParent=null===(a=null===(s=null===(o=null===(r=this._minimizedComposeWindowContainerWrapperList)||void 0===r?void 0:r.parentElement)||void 0===o?void 0:o.parentElement)||void 0===s?void 0:s.parentElement)||void 0===a?void 0:a.parentElement,this._minimizedComposeWindowContainerWrapper=Array.from(null!==(c=null===(l=this._minimizedComposeWindowContainerWrapperList)||void 0===l?void 0:l.querySelectorAll(":scope > .nH.nn"))&&void 0!==c?c:[]).find((e=>!e.hasChildNodes()&&"2147483647"!==e.style.order)),this._hubspotSalesExtensionSidebarWidget=this._targetTextField.ownerDocument.querySelector(".hubspot.hubspot-sales-sidebar-tab-container"),u&&d&&this._composeWindow&&this._composeWindowContent&&this._minimizedComposeWindowContainerWrapperList&&this._minimizedComposeWindowContainerWrapper&&this._minimizedComposeWindowContainerWrapperListParent?{proofitButtonLayout:{sibling:d,popupStyle:{zIndex:1}},proofitInProgressTabLayout:{container:this._minimizedComposeWindowContainerWrapper,mounted:this._inProgressRequestTracker.sameRequestInProgress(this._messageId),onMount:()=>this._onMountInProgressTab(),onUnmount:()=>this._onUnmountInProgressTab(),style:{position:"absolute",bottom:0,right:66,visibility:"visible"},conflictingTabMounted:this._inProgressRequestTracker.differentRequestInProgress(this._messageId),shouldLimitInteraction:!0},proofitHighlightsLayout:{container:this._fieldContainer,style:{position:"absolute",zIndex:j.wJ}},proofitInProgressDraftItemLayout:null}:null}_onMountInProgressTab(){if(this._composeWindow&&this._composeWindowContent&&this._minimizedComposeWindowContainerWrapperList&&this._minimizedComposeWindowContainerWrapper&&this._minimizedComposeWindowContainerWrapperListParent){if(this._inProgressRequestTracker.currentId()===this._messageId)return;this._addFullScreenOverlay(),this._allComposeTabContainers().forEach((e=>this._hideComposeTab(e))),this._minimizedComposeWindowContainerWrapperListParent.style.top="0",this._minimizedComposeWindowContainerWrapperListParent.style.position="absolute",this._minimizedComposeWindowContainerWrapperListParent.style.zIndex=j.wJ.toString(),this._hideComposeWindowContent(),this._inProgressRequestTracker.markInProgress(this._messageId)}}_onUnmountInProgressTab(){if(this._composeWindow&&this._composeWindowContent&&this._minimizedComposeWindowContainerWrapperList&&this._minimizedComposeWindowContainerWrapper&&this._minimizedComposeWindowContainerWrapperListParent){if(this._inProgressRequestTracker.currentId()!==this._messageId)return;this._removeFullScreenOverlay(),this._allComposeTabContainers().forEach((e=>this._showComposeTab(e))),this._minimizedComposeWindowContainerWrapper.style.height="",this._minimizedComposeWindowContainerWrapperListParent.style.top="",this._minimizedComposeWindowContainerWrapperListParent.style.position="",this._minimizedComposeWindowContainerWrapperListParent.style.zIndex="",this._composeWindowContent.style.display="block",this._progressMessageElement&&(this._progressMessageElement.remove(),this._progressMessageElement=null),this._inProgressRequestTracker.markNotInProgress(),this._targetTextField.focus()}}_allComposeTabContainers(){var e,t;return Array.from(null!==(t=null===(e=this._minimizedComposeWindowContainerWrapperList)||void 0===e?void 0:e.querySelectorAll(":scope > .nH.nn > .no"))&&void 0!==t?t:[])}_hideComposeWindowContent(){var e;this._composeWindowContent&&(this._composeWindowContent.style.display="none",this._progressMessageElement=this._buildProgressMessageElement(),null===(e=this._composeWindowContent.parentElement)||void 0===e||e.appendChild(this._progressMessageElement))}_buildProgressMessageElement(){const e=this._targetTextField.ownerDocument.createElement("div");return e.style.background="#F5F5F5",e.style.borderRadius="2px",e.style.color="#777",e.style.marginLeft="8px",e.style.marginTop="12px",e.style.padding="7px",e.textContent="Your email is being reviewed by our experts.",e}_addFullScreenOverlay(){var e;const t=this._targetTextField.ownerDocument.createElement("div");if(t.style.height="100%",t.style.width="100%",t.style.position="absolute",t.style.top="0",t.style.left="0",t.setAttribute("data-grammarly-proofit-in-progress-overlay","true"),this._fullscreenOverlay){const e=getComputedStyle(this._fullscreenOverlay);t.style.backgroundColor=e.backgroundColor,t.style.zIndex=e.zIndex,this._fullscreenOverlay.style.visibility="hidden"}else t.style.backgroundColor="rgba(0, 0, 0, 0.5)",t.style.zIndex="6";null===(e=this._minimizedComposeWindowContainerWrapperListParent)||void 0===e||e.insertAdjacentElement("beforebegin",t),this._hubspotSalesExtensionSidebarWidget&&(this._hubspotSalesExtensionSidebarWidget.style.visibility="hidden")}_removeFullScreenOverlay(){var e;null===(e=this._targetTextField.ownerDocument.body.querySelector('div[data-grammarly-proofit-in-progress-overlay="true"]'))||void 0===e||e.remove(),this._hubspotSalesExtensionSidebarWidget&&(this._hubspotSalesExtensionSidebarWidget.style.visibility="visible")}}var U=i(33432)},97077:(e,t,i)=>{if(i.r(t),i.d(t,{ProofitButtonView:()=>n.h,ProofitHighlightsView:()=>s.P,ProofitInProgressDraftItemOverlayView:()=>a.X,ProofitInProgressTabView:()=>o.K,ProofitViewInjector:()=>r.E}),6168!=i.j)var n=i(27818);if(6168!=i.j)var r=i(33432);if(6168!=i.j)var o=i(94203);if(6168!=i.j)var s=i(5327);if(6168!=i.j)var a=i(92352)},27818:(e,t,i)=>{i.d(t,{h:()=>S});var n=i(49231);if(6168!=i.j)var r=i(13391);if(6168!=i.j)var o=i(47387);if(6168!=i.j)var s=i(78129);if(6168!=i.j)var a=i(84308);if(6168!=i.j)var l=i(90572);if(6168!=i.j)var c=i(84178);if(6168!=i.j)var u=i(8065);if(6168!=i.j)var d=i(29479);if(6168!=i.j)var h=i(64271);if(6168!=i.j)var p=i(84714);if(6168!=i.j)var m=i(9273);if(6168!=i.j)var g=i(954);if(6168!=i.j)var f=i(63532);if(6168!=i.j)var v=i(81446);if(6168!=i.j)var _=i(59179);if(6168!=i.j)var b=i(2485);if(6168!=i.j)var y=i(26590);if(6168!=i.j)var w=i(88927);if(6168!=i.j)var E=i(25103);const S=({layout:e,gButtonIsVisible:t,requestDisabledInfo:i,requestStatus:S,assistantActiveView:C,onOpenAssistant:I,onCloseAssistant:T,startedThenStoppedTyping:P,mouseObservable:A})=>{const[k,R]=n.useState(!1);n.useEffect((()=>{const e=S.pipe(s.G()).subscribe((([e,t])=>{const i=e!==y.eE.CANCELED&&t===y.eE.CANCELED,n=e!==y.eE.ERROR&&t===y.eE.ERROR,r=e!==y.eE.REJECTED&&t===y.eE.REJECTED;R(i?"canceled":n?"error":!!r&&"rejected")}));return()=>e.unsubscribe()}),[]);const M=r.h.create(!1);return(0,w.A)(a.a([i,P]).pipe(l.h((([e,t])=>null===e&&!0===t)),c.q(1),u.b((()=>A.pipe(d.h(!0),c.q(1)))),u.b((()=>h.T(p.of(!0),m.timer(4e3).pipe(d.h(!1),c.q(1))))),g.O(!1),f.b(v.wW(M)))),n.createElement(o.F.Fragment,null,a.a([e.pipe(_.U((e=>null==e?void 0:e.proofitButtonLayout))),t,i,S,C,M]).pipe(_.U((([e,t,i,r,o,s])=>e&&t?n.createElement(E._,{style:{marginLeft:12,marginTop:4},onClick:()=>{R(!1),(null==o?void 0:o.type)===b.a.Type.proofitRequest||(null==o?void 0:o.type)===b.a.Type.proofitReview?T():I()},showPopup:k,onPopupClose:()=>R(!1),disabledInfo:i,disableIntroTooltip:r!==y.eE.IDLE||(null==o?void 0:o.type)===b.a.Type.proofitRequest||(null==o?void 0:o.type)===b.a.Type.proofitReview,popupStyle:e.popupStyle,isEmphasized:s}):null))))}},5327:(e,t,i)=>{i.d(t,{P:()=>u});var n=i(49231);if(6168!=i.j)var r=i(47387);if(6168!=i.j)var o=i(84308);if(6168!=i.j)var s=i(59179);if(6168!=i.j)var a=i(2485);if(6168!=i.j)var l=i(26590);if(6168!=i.j)var c=i(76211);const u=({layout:e,requestInfo:t,assistantActiveView:i,isUsingSDUI:u})=>n.createElement(r.F.Fragment,null,o.a([e.pipe(s.U((e=>null==e?void 0:e.proofitHighlightsLayout.style))),t,i,u]).pipe(s.U((([e,t,i,r])=>!0!==r&&(null==i?void 0:i.type)!==a.a.Type.proofitReview||!e||t.status!==l.eE.REVIEWING?null:t.highlights.map((t=>t.rects.map((i=>n.createElement(c.R,{key:`${t.originalText}-${t.range.start}-${t.range.end}`,originalText:t.originalText,top:i.top,left:i.left,height:i.height,width:i.width,position:e.position,zIndex:e.zIndex})))))))))},92352:(e,t,i)=>{i.d(t,{X:()=>h});var n=i(49231);if(6168!=i.j)var r=i(47387);if(6168!=i.j)var o=i(84308);if(6168!=i.j)var s=i(59179);if(6168!=i.j)var a=i(20161);if(6168!=i.j)var l=i(954);if(6168!=i.j)var c=i(84714);if(6168!=i.j)var u=i(26590);if(6168!=i.j)var d=i(22408);const h=({layout:e,requestInfo:t})=>{const i=[u.eE.ACCEPTED,u.eE.IN_PROGRESS,u.eE.COMPLETED];return n.createElement(r.F.Fragment,null,o.a([e.pipe(s.U((e=>null==e?void 0:e.proofitInProgressDraftItemLayout))).pipe(a.w((e=>{var t,i;return null!==(i=null===(t=null==e?void 0:e.clientRect)||void 0===t?void 0:t.pipe(l.O(null)))&&void 0!==i?i:c.of(null)}))),e.pipe(s.U((e=>{var t;return null===(t=null==e?void 0:e.proofitInProgressDraftItemLayout)||void 0===t?void 0:t.style}))),t.view("status")]).pipe(s.U((([e,t,r])=>e&&t&&i.includes(r)?n.createElement(d.u,{showDelay:1e3,message:n.createElement(n.Fragment,null,n.createElement("b",null,"We're reviewing your email now."),n.createElement("br",null),"This will take just a few moments. We've temporarily paused your draft while the experts work on it."),withGrammarlyIcon:!0},n.createElement("div",{"data-grammarly-part":"proofit-in-progress-draft-item-overlay",style:{top:e.top,left:e.left,width:e.width,height:e.height,...t}})):null))))}},94203:(e,t,i)=>{i.d(t,{K:()=>h});var n=i(49231);if(6168!=i.j)var r=i(47387);if(6168!=i.j)var o=i(84308);if(6168!=i.j)var s=i(59179);if(6168!=i.j)var a=i(63532);if(6168!=i.j)var l=i(29227);if(6168!=i.j)var c=i(26590);if(6168!=i.j)var u=i(38582);if(6168!=i.j)var d=i(78708);const h=({layout:e,requestInfo:t,turnaroundTime:i,onCancel:h,onReview:p})=>{const[m,g]=n.useState(null),[f,v]=n.useState(null),[_,b]=n.useState(null),[y,w]=n.useState(null),E=[c.eE.ACCEPTED,c.eE.IN_PROGRESS,c.eE.COMPLETED];return n.createElement(r.F.Fragment,null,o.a([e.pipe(s.U((e=>null==e?void 0:e.proofitInProgressTabLayout))),t,i]).pipe(a.b((([e,t])=>{e&&E.includes(t.status)?e.onMount():e&&!E.includes(t.status)&&(e.onUnmount(),g(null),b(null),f&&clearTimeout(f),y&&clearTimeout(y))})),s.U((([e,t,i])=>{var r;const{suggestionsMade:o,slicesChecked:s,totalSlices:a,status:f,secondsRemaining:y,activeReviewers:S}=t;if(e&&E.includes(t.status)){const t=f===c.eE.ACCEPTED,E=f===c.eE.IN_PROGRESS,C=f===c.eE.COMPLETED;let I=0;a>0&&(I=s/a*100);let T,P="",A=!0;if(t)P="Connecting you to experts...";else if(E){P=o>0?`${o} ${(0,l._6)(o,"suggestion","suggestions")} made so far...`:"Review in progress...";const e=null!=y?y:i;A=e>0,T=A?S>0?`${S} ${(0,l._6)(S,"expert","experts")} reviewing...`:`About ${e} ${(0,l._6)(e,"second","seconds")} remaining...`:"Wrapping up..."}else P=`${o} ${(0,l._6)(o,"suggestion","suggestions")}`;let k,R,M="";return C?null===_?(g(!1),b(!0),w(setTimeout((()=>b(!1)),7e3))):_&&(M="Your email is ready!",k="Suggestions are highlighted.",R=()=>b(!1)):null===m?(g(!0),v(setTimeout((()=>g(!1)),7e3))):m&&(M="We're reviewing your email now.",k=n.createElement(n.Fragment,null,"This takes just a few moments.",e.shouldLimitInteraction?n.createElement(n.Fragment,null,n.createElement("br",null),"This page is temporarily paused while the experts review your email."):null),R=()=>g(!1)),n.createElement("div",{style:{...e.style}},n.createElement(u.p,{show:null!==(r=m||_)&&void 0!==r?r:void 0,title:M,message:k,onClose:R,placement:"top",headerIcon:_?"notification-ok":void 0},C?n.createElement(d.B,{isCompleted:C,title:P,onReview:p}):n.createElement(d.B,{isCompleted:C,title:P,secondaryTitle:T,progress:I,onCancel:h,onToggleMenu:e=>{e&&(null==R||R())},hideProgressBar:!A,allowCancellation:!A,turnaroundTime:i})))}return null}))))}},33432:(e,t,i)=>{i.d(t,{E:()=>a});var n=i(49231),r=i(80471),o=i(28896),s=i(39903);class a{constructor(e,t,i){this._outerDoc=e,this._proofitLayout=t,this._proofitElements=i,this._proofitButtonView=void 0,this._proofitInProgressTabView=void 0,this._proofitInProgressDraftItemOverlayView=void 0,this._proofitHighlightsView=void 0}inject(e){this._proofitButtonView=r.V.get({monitorAs:"proofit-button"}).inject(o.EM.fromDocument(this._outerDoc,"grammarly-proofit-button"),(e=>{var t;e.style.zIndex="1",null===(t=this._proofitLayout)||void 0===t||t.proofitButtonLayout.sibling.insertAdjacentElement("afterend",e)}),s.G7.showWhenLoaded(n.createElement(this._proofitElements.proofitButton,null))),this._proofitInProgressTabView=r.V.get({monitorAs:"proofit-in-progress-tab"}).inject(o.EM.fromDocument(this._outerDoc,"grammarly-proofit-in-progress-tab"),(e=>{var t;null===(t=this._proofitLayout)||void 0===t||t.proofitInProgressTabLayout.container.appendChild(e)}),s.G7.showWhenLoaded(n.createElement(this._proofitElements.proofitInProgressTab,null))),this._proofitInProgressDraftItemOverlayView=r.V.get({monitorAs:"proofit-in-progress-draft-item-overlay"}).inject(o.EM.fromDocument(this._outerDoc,"grammarly-proofit-in-progress-draft-item-overlay"),o.zs.appendChild(this._outerDoc.documentElement),s.G7.showWhenLoaded(n.createElement(this._proofitElements.proofitInProgressDraftItemOverlay,null)),{eventPropagationHandler:null==e?void 0:e.eventPropagationHandler}),this._proofitHighlightsView=r.V.get({monitorAs:"proofit-highlights"}).inject(o.EM.fromDocument(this._outerDoc,"grammarly-proofit-highlights"),(e=>{var t,i;null===(i=null===(t=this._proofitLayout)||void 0===t?void 0:t.proofitHighlightsLayout.container)||void 0===i||i.appendChild(e)}),s.G7.showWhenLoaded(n.createElement(this._proofitElements.proofitHighlights,null)))}dispose(){var e,t,i,n;null===(e=this._proofitButtonView)||void 0===e||e.dispose(),null===(t=this._proofitInProgressTabView)||void 0===t||t.dispose(),null===(i=this._proofitInProgressDraftItemOverlayView)||void 0===i||i.dispose(),null===(n=this._proofitHighlightsView)||void 0===n||n.dispose()}}},6641:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(13391);class r{constructor(e,t){this._viewHistory=[],this._startupPlaceHolder=e,this._activeView=n.h.create(this._startupPlaceHolder),this._defaultView=t}get activeView(){return this._activeView.view()}get lastView(){return this._viewHistory[this._viewHistory.length-1]||this._defaultView}pushActiveView(e){const t=this._activeView.get();e.type!==t.type&&(t.type!==this._startupPlaceHolder.type&&this._viewHistory.push(t),this._activeView.set(e))}popActiveView(){const e=this._viewHistory.pop()||this._defaultView;this._activeView.set(e)}replaceActiveView(e){e.type!==this._activeView.get().type&&this._activeView.set(e)}}},96077:(e,t,i)=>{i.d(t,{H:()=>n});var n,r=i(34527),o=i(13391);!function(e){const t=o.h.create(""),i=new Proxy({textContent:""},{get:(e,i)=>"textContent"===i?t.get():Reflect.get(e,i),set:(e,i,n)=>"textContent"===i&&"string"==typeof n?(t.set(n),!0):Reflect.set(e,i,n)});e.init=function(){r.ux.setStylesTarget(i)},e.styles=t.view()}(n||(n={}))},90447:(e,t,i)=>{i.d(t,{YS:()=>b,mE:()=>v,nS:()=>n,o6:()=>h});var n,r=i(49231),o=i(32073),s=i(13391),a=i(37213),l=i(41580),c=i(78542),u=i(96077),d=i(39903);!function(e){e.Context=r.createContext(null)}(n||(n={}));const h=16;function p(e,t){e&&e instanceof HTMLElement?e.style.setProperty("--rem",`${t}`):c.Y.create("ShadowRootInjector").warn("setRootCssVar: host is not an HTMLElement. This should not happen. Please report this issue.")}class m{constructor(){this._denaliStyleSheet=new CSSStyleSheet,this._globalStyleSheet=new CSSStyleSheet,this._globalStyleSheetLoaded=s.h.create(null),this._subscription=new o.w0}inject(e,t){const i=this._globalStyleSheetInitialized();i||this._initGlobalStyleSheet();const o=e.attachShadow({mode:"open"});o.adoptedStyleSheets=[this._denaliStyleSheet,this._globalStyleSheet],p(o.host,h);const s=(0,d.X3)(o,r.createElement(n.Context.Provider,{value:o},r.createElement(t,{viewLoaded:this._globalStyleSheetLoaded.view((e=>({...e,constructableStyleSheetInitialized:i})))})));return()=>{s(),this._subscription.unsubscribe()}}_globalStyleSheetInitialized(){return this._globalStyleSheet.cssRules.length>0}async _initGlobalStyleSheet(){try{if(!self.GR_INLINE_STYLES)throw new Error("No inline styles");await Promise.all([this._denaliStyleSheet.replace(u.H.styles.get()),this._globalStyleSheet.replace(self.GR_INLINE_STYLES)]),this._globalStyleSheetLoaded.set({stylesInjectionStrategy:"constructableStyleSheet"}),this._subscription.add(u.H.styles.subscribe((e=>this._denaliStyleSheet.replaceSync(e))))}catch(e){this._globalStyleSheetLoaded.set({error:`${e}`,stylesInjectionStrategy:"constructableStyleSheet"})}}}const g=(0,a.xb)(l.b);class f{inject(e,t){const i=s.h.create(null),o=e.attachShadow({mode:"open"});return p(o.host,h),(0,d.X3)(o,r.createElement(r.Fragment,null,r.createElement(g,null,u.H.styles),r.createElement(l.b,null,self.GR_INLINE_STYLES),r.createElement(n.Context.Provider,{value:o},r.createElement(t,{viewLoaded:i}))),(()=>i.set({stylesInjectionStrategy:"styleElement"})))}}class v{inject(e,t){const i=s.h.create(null),o=e.attachShadow({mode:"open"});return(0,d.X3)(o,r.createElement(r.Fragment,null,r.createElement(n.Context.Provider,{value:o},r.createElement(t,{viewLoaded:i}))),(()=>i.set({stylesInjectionStrategy:"noStyles"})))}}let _=null;function b(e=!1){return e&&function(){if(null===_)try{const e=new CSSStyleSheet;_=!!e&&!!e.replace&&!!e.replaceSync&&"adoptedStyleSheets"in Document.prototype}catch(e){_=!1}return!0===_}()?new m:new f}},39903:(e,t,i)=>{i.d(t,{G7:()=>f,X3:()=>m});var n=i(49231),r=i(64151),o=i(84714),s=i(2613),a=i(14969),l=i(29479),c=i(954),u=i(24666),d=i(59179),h=i(47387);function p(e){return!!e&&!e.error}function m(e,t,i){return(0,r.render)(t,e,i),()=>(0,r.unmountComponentAtNode)(e)}const g=({view:e,placeholder:t,viewLoaded:i,minDuration:r,forcePlaceholder:u})=>{const d=p(i.get())&&!u?(0,o.of)(e):i.pipe((0,s.e)(r),(0,a.P)(p),(0,l.h)(e),(0,c.O)(t));return n.createElement(h.F.Fragment,null,d)};var f;!function(e){e.showWhenLoaded=function(e){return function({viewLoaded:t}){return n.createElement(h.F.Fragment,null,t.pipe((0,u.x)(),(0,d.U)((t=>p(t)?e:null))))}},e.withPlaceholder=function(e,t,i,r){return function({viewLoaded:o}){return n.createElement(g,{view:e,placeholder:t,minDuration:i||0,viewLoaded:o,forcePlaceholder:r||!1})}}}(f||(f={}))},28896:(e,t,i)=>{i.d(t,{EM:()=>n,_R:()=>g,aP:()=>f,zs:()=>r});var n,r,o=i(49231),s=i(32073),a=i(13391),l=i(96414),c=i(20182),u=i(18506),d=i(96077),h=i(39903),p=i(77671);class m{constructor(e,t,i,n){var r,o,s;this._options=n,this._root=null,this._unmount=null,this._root=e(),t(this._root),this._unmount=i(this._root),(null===(r=this._options)||void 0===r?void 0:r.allowPrint)||this._root.classList.add(p.gr_no_print),(null===(o=this._options)||void 0===o?void 0:o.eventPropagationHandler)&&(this._disposeEventPropagationHandler=null===(s=this._options)||void 0===s?void 0:s.eventPropagationHandler(this._root)),this._preventEventPropagation()}_preventEventPropagation(){const e=["keydown","keyup","keypress","mouseup","mousedown","pointerdown","click"];(0,u.OB)().experimentClient.isGateEnabled(c.K.CentralizeStopEventPropagation)&&e.forEach((e=>{var t;null===(t=this._root)||void 0===t||t.addEventListener(e,(e=>{e.stopPropagation()}))}))}dispose(){this._disposeEventPropagationHandler&&(this._disposeEventPropagationHandler(),this._disposeEventPropagationHandler=void 0),this._unmount&&(this._unmount(),this._unmount=null),this._root&&(this._root.parentNode?this._root.parentNode.removeChild(this._root):this._root.remove(),this._root=null)}}class g extends m{constructor(e,t,i,n){super(e,t,(e=>{var t,n;const r=new s.w0,l=e.ownerDocument,c=l.head,u="grammarly-extension-styles",p="grammarly-extension-denali-styles";let m=Array.from(null!==(t=c.getElementsByTagName("style"))&&void 0!==t?t:[]).find((e=>e.id===u)),g=Array.from(null!==(n=c.getElementsByTagName("style"))&&void 0!==n?n:[]).find((e=>e.id===p));m||(m=l.createElement("style"),m.id=u,m.innerHTML=self.GR_INLINE_STYLES||"",c.prepend(m)),g||(g=l.createElement("style"),g.id=p,m.insertAdjacentElement("beforebegin",g)),g.innerHTML=d.H.styles.get(),r.add(d.H.styles.subscribe((e=>{g&&(g.innerHTML=e)})));const f=a.h.create(null),v=(0,h.X3)(e,o.createElement(i,{viewLoaded:f}),(()=>f.set({shadowDOM:!1})));return()=>{r.unsubscribe(),v()}}),n)}}class f extends m{constructor(e,t,i,n,r){super((()=>{const t=e();return t.setAttribute(f.SHADOW_DOM_ROOT_ATTRIBUTE,"true"),t.tagName.toLocaleLowerCase()===l.Hq.toLocaleLowerCase()&&(null==r?void 0:r.vBarsCustomAttributes)&&Object.entries(r.vBarsCustomAttributes).forEach((([e,i])=>{t.setAttribute(e,i)})),t}),t,(e=>n.get().inject(e,(e=>o.createElement(i,{viewLoaded:e.viewLoaded.view((e=>e?{...e,shadowDOM:!0}:null))})))),r)}}f.SHADOW_DOM_ROOT_ATTRIBUTE="data-grammarly-shadow-root",function(e){e.defaultName="grammarly-extension",e.fromDocument=function(t,i=e.defaultName,n={}){return{doc:t,name:i,attributes:n}}}(n||(n={})),function(e){e.appendChild=function(e){return{parent:e}},e.isCustom=function(e){return e instanceof Function}}(r||(r={}))},80471:(e,t,i)=>{i.d(t,{V:()=>c});var n=i(23031),r=i(49231),o=i(14969),s=i(56209);class a{constructor(e,t){this._injector=e,this._injectionName=t}inject(e,t,i,n){const o=performance.now(),c=a._firstRender,u=a._somePreviousRenderCompleted;return a._firstRender=!1,this._injector(e,t,(({viewLoaded:e})=>r.createElement(l,{view:i,viewLoaded:e,onComplete:e=>{const t=performance.now();(0,s.Tb)().performance.viewInjection({timeToRender:Math.trunc(t-o),startTime:Math.trunc(o),endTime:Math.trunc(t),injectionName:this._injectionName,firstRender:c,somePreviousRenderCompleted:u,error:e.error||null,shadowDOM:!!e.shadowDOM,stylesInjectionStrategy:e.stylesInjectionStrategy||null,constructableStyleSheetInitialized:!!e.constructableStyleSheetInitialized}),a._somePreviousRenderCompleted=!0}})),n)}}a._firstRender=!0,a._somePreviousRenderCompleted=!1;const l=({viewLoaded:e,view:t,onComplete:i})=>(r.useEffect((()=>{const t=e.pipe((0,o.P)(n.fQ)).subscribe(i);return()=>null==t?void 0:t.unsubscribe()}),[]),r.createElement(t,{viewLoaded:e}));var c,u=i(90447),d=i(28896);function h(e){const t=e.doc.createElement(e.name);return e.attributes&&Object.entries(e.attributes).forEach((([e,i])=>{t.setAttribute(e,i)})),t}!function(e){const t=(0,n.Vo)(u.YS);e.get=function(e){return{inject:(i,r,o,s)=>{const l=(null==e?void 0:e.monitorAs)||i.name||"unknown";return new a((null==e?void 0:e.noShadowDOM)?(e,t,i,n)=>new d._R((()=>h(e)),d.zs.isCustom(t)?t:e=>t.parent.appendChild(e),i,n):(c=(null==e?void 0:e.noStyles)?(0,n.Vo)((()=>new u.mE)):t,(e,t,i,n)=>new d.aP((()=>h(e)),d.zs.isCustom(t)?t:e=>t.parent.appendChild(e),i,c,n)),l).inject(i,r,o,s);var c}}}}(c||(c={}))},21536:(e,t,i)=>{i.d(t,{d:()=>s});var n=i(49231),r=i(92244),o=i(25965);const s=n.forwardRef((function({children:e,onClickAway:t,additionalEventSources:i,additionalIgnoredEventSources:s=[],onCapturePhase:a=!1},l){const c=n.useRef(null),u=n.useCallback((e=>{if(!c.current)return;const{target:i}=e,n=(0,r.Me)(c.current),o=!(i instanceof Node)||!s.some((e=>e.contains(i)))&&n.documentElement&&n.documentElement.contains(i)&&!e.composedPath().some((e=>{var t;return e instanceof Node&&(null===(t=c.current)||void 0===t?void 0:t.contains(e))}));o&&t(e)}),[t,c]);n.useEffect((()=>{var e,t;const n=[...new Set([...i||[],null!==(t=null===(e=null==c?void 0:c.current)||void 0===e?void 0:e.ownerDocument)&&void 0!==t?t:document])];return n.forEach((e=>e.addEventListener("click",u,{capture:a}))),()=>{n.forEach((e=>e.removeEventListener("click",u,{capture:a})))}}),[u,c]);const d={ref:(0,o.l)([l,c,...(0,o.O)(e)?[e.ref]:[]])};return n.cloneElement(e,d)}))},41038:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(49231),r=i(37213),o=i(95071),s=i.n(o);const a=n.forwardRef(((e,t)=>{const{kind:i="primary",size:o="medium",includePadding:a=!0,round:l=!1,dataGrammarlyPart:c="ui-kit-button",className:u,...d}=e;return n.createElement("button",{...(0,r.Sh)(s().button,"primary"===i?s().buttonPrimary:null,"success"===i?s().buttonSuccess:null,"link"===i?s().buttonLink:null,"outlined"===i?s().buttonOutlined:null,"transparent"===i||"transparent-hoverable"===i?s().buttonTransparent:null,"transparent-hoverable"===i?s().buttonTransparentHoverable:null,"dark"===i?s().buttonDark:null,"neutral"===i?s().buttonNeutral:null,"neutral-white"===i?s().buttonNeutralWhite:null,"premium"===i?s().buttonPremium:null,"small"===o?s().buttonSmall:null,"medium"===o?s().buttonMedium:null,a?s().buttonWithPadding:null,l?s().buttonRound:null,d.disabled?s().buttonDisabled:s().buttonEnabled,u),ref:t,"data-grammarly-part":c,...d})}));a.displayName="Button";n.forwardRef((function(e,t){return n.createElement("span",{...e,...(0,r.Sh)(e.className,s().secondaryText),ref:t})}))},35352:(e,t,i)=>{i.d(t,{P:()=>u});var n=i(49231),r=i(37213),o=i(9358),s=i(46180),a=i(22408),l=i(41249),c=i.n(l);const u=({size:e="medium",color:t="dark",tooltipMessage:i,...l})=>n.createElement(a.u,{message:i,showDelay:o.gk,disabled:!i},n.createElement(s.h,{"aria-label":"Close",...l},n.createElement("div",{...(0,r.Sh)("small"===e?c().closeButtonSmallIcon:null,"medium"===e?c().closeButtonMediumIcon:null,"white"===t?c().closeButtonWhiteIcon:null)})))},46180:(e,t,i)=>{i.d(t,{h:()=>o});var n=i(49231),r=i(41038);const o=n.forwardRef((function({kind:e="transparent-hoverable",...t},i){return n.createElement(r.z,{...t,kind:e,includePadding:!1,ref:i})}))},61022:(e,t,i)=>{i.d(t,{X:()=>u});var n=i(49231),r=i(37213),o=i(35352),s=i(55849),a=i(73563),l=i(54429),c=i.n(l);const u=n.forwardRef((function({headerIcon:e,headerContent:t,mainContent:i,onClose:s,size:a="large",includeMainContentPadding:l=!0,style:u,className:p,attributes:m,headerStyle:g,headerContentStyle:f,theme:v="light",dataGrammarlyPart:_="ui-kit-pane",closeButton:b=(e=>n.createElement(o.P,{onClick:e}))},y){const w=h(e);return n.createElement("div",{"data-grammarly-part":_,...(0,r.Sh)(c().pane,p,"small"===a?c().paneSmall:null,"medium"===a?c().paneMedium:null,"large"===a?c().paneLarge:null,"extra-large"===a?c().paneExtraLarge:null,d(v)),ref:y,style:u,...m},w||t||Boolean(s)?n.createElement("div",{...(0,r.Sh)(c().paneHeaderContentContainer,s?c().paneHeaderContentContainerWithCloseButton:null),style:g},s?b(s):null,w||t?n.createElement("div",{className:c().paneHeaderContent,style:f},w,t):null):null,n.createElement("div",{...(0,r.Sh)(c().paneMainContent,l?null:c().paneMainContentWithoutPadding)},i))})),d=e=>"dark"===e?c().paneDark:"darkDS"===e?c().paneDarkDS:null,h=e=>e?"logo"===e?n.createElement(s.T,{type:"mini",className:c().paneHeaderContentIcon}):"logo-with-name"===e?n.createElement(s.T,{className:c().paneHeaderContentIcon}):"logo-error"===e?n.createElement(a.e,{level:"error",className:c().paneHeaderContentIcon}):n.createElement("div",{...(0,r.Sh)(c().paneHeaderContentIcon,"notification-ok"===e?c().paneHeaderContentIconNotificationOK:null,"notification-warning"===e?c().paneHeaderContentIconNotificationWarning:null)}):null},47897:(e,t,i)=>{i.d(t,{J:()=>h});var n=i(49231),r=i(19232),o=i(37213),s=i(21536),a=i(35352),l=i(61022),c=i(68553),u=i(3538),d=i(42527);const h=({headerIcon:e,headerContent:t,mainContent:i,show:h=!1,placement:p="auto",showArrow:m=!0,onClose:g,size:f="large",includeMainContentPadding:v=!0,style:_,referenceElementStyle:b,boundaryAreaPadding:y,theme:w="light",distanceFromReferenceElement:E=("lightDS"===w?c.uy:8),dataGrammarlyPart:S="ui-kit-popover",disablePositionUpdates:C=!1,clickAwayOptions:I,closeButton:T=(e=>n.createElement(a.P,{onClick:e})),...P})=>{var A,k,R,M;const[x,L]=n.useState(null),[D,W]=n.useState(null),[O,N]=n.useState(null),{styles:F,attributes:q,state:z}=(0,r.D)(P.isOutsideReferenceElement?P.outsideReferenceElement:x,D,{placement:p,modifiers:[{name:"offset",options:{offset:[0,E]}},{name:"arrow",options:{element:O,padding:E}},...C?[{name:"eventListeners",enabled:!1}]:[],...y?[{name:"preventOverflow",options:{padding:y}}]:[]]}),j=n.createElement(n.Fragment,null,P.isOutsideReferenceElement?null:n.createElement("div",{className:d.popoverReferenceElement,style:{...b},ref:L},P.children),h?n.createElement(l.X,{dataGrammarlyPart:S,headerIcon:e,headerContent:t,closeButton:T,mainContent:n.createElement(n.Fragment,null,i,m?"lightDS"===w?n.createElement(c.QH,{ref:N,style:F.arrow,placement:null==z?void 0:z.placement}):n.createElement("div",{...(0,o.Sh)(u.popoverArrowElement,"dark"===w?u.popoverArrowElementDark:"darkDS"===w?u.popoverArrowElementDarkDS:null,(null===(A=null==z?void 0:z.placement)||void 0===A?void 0:A.startsWith("bottom"))?u.popoverArrowElementBottom:null,(null===(k=null==z?void 0:z.placement)||void 0===k?void 0:k.startsWith("top"))?u.popoverArrowElementTop:null,(null===(R=null==z?void 0:z.placement)||void 0===R?void 0:R.startsWith("right"))?u.popoverArrowElementRight:null,(null===(M=null==z?void 0:z.placement)||void 0===M?void 0:M.startsWith("left"))?u.popoverArrowElementLeft:null),ref:N,style:F.arrow}):null),ref:W,style:{..._,...F.popper,..."lightDS"===w&&m?{boxShadow:"none"}:{}},className:"lightDS"===w&&m?d.lightDSPopover:void 0,attributes:q.popper,includeMainContentPadding:v,size:f,onClose:g,theme:w}):null);return I&&h?n.createElement(s.d,{onClickAway:I.onClickAway,additionalEventSources:I.additionalEventSources},n.createElement("div",null,j)):j}},68553:(e,t,i)=>{i.d(t,{QH:()=>o,uy:()=>r});var n=i(49231);const r=12,o=n.forwardRef((function({placement:e,style:t},i){return n.createElement("div",{ref:i,style:{width:33}},n.createElement("svg",{width:33,height:12,viewBox:"0 0 33 12.5",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{position:"absolute",...t,transform:`${(null==t?void 0:t.transform)||""} rotate(${s(e)}deg)`.trimStart(),...a(e)}},n.createElement("path",{d:"M0.5 3.41877e-07C3.5 3.41877e-07 29.5 3.41877e-07 32.5 3.41877e-07C28.5 3.41877e-07 26.4111 0.903505 24.1814 3.69994L17.5562 11.4728C16.957 12.1757 15.8652 12.1757 15.2661 11.4728L8.64084 3.69994C6.41113 0.903505 4.5 3.41877e-07 0.5 3.41877e-07Z",fill:"white"})))}));function s(e){return(null==e?void 0:e.startsWith("right"))?90:(null==e?void 0:e.startsWith("bottom"))?180:(null==e?void 0:e.startsWith("left"))?270:0}function a(e){return(null==e?void 0:e.startsWith("bottom"))?{top:-12}:(null==e?void 0:e.startsWith("top"))?{bottom:-12}:(null==e?void 0:e.startsWith("right"))?{transformOrigin:"top left",top:-16.5,left:0}:(null==e?void 0:e.startsWith("left"))?{transformOrigin:"top right",top:-16.5,right:0}:{}}},23951:(e,t,i)=>{i.d(t,{m:()=>p});var n=i(90023),r=i(49231),o=i(22299),s=i(37213),a=i(68340),l=i(63532),c=i(22408),u=i(47897),d=i(79707),h=i.n(d);const p=({ariaMenuId:e,ariaMenuLabel:t,sections:i,trigger:d={action:"click"},placement:p,onToggle:m,children:g,referenceElementStyle:f,size:v="small",theme:_,style:b,distanceFromReferenceElement:y,dataGrammarlyPart:w="ui-kit-popover-menu",onItemMount:E})=>{const S=r.useRef(null),C=[],I=r.useRef(null),T=`trigger-element-id-${e}`,[P,A]=r.useState(!1),[k,R]=r.useState(null),M=r.useRef(null),x=r.useRef(null),L=i.flatMap((e=>e.items)),D=L.some((e=>Boolean(e.icon))),W=r.useCallback((()=>{"click"===(null==d?void 0:d.action)&&A(!P)}),[d,P]),O=r.useCallback((()=>{"hover"===(null==d?void 0:d.action)&&(P&&null!==x.current?(self.clearTimeout(x.current),x.current=null):P||(d.delay?(null!==M.current&&self.clearTimeout(M.current),M.current=self.setTimeout((()=>{A(!0),M.current=null}),d.delay)):A(!0)))}),[d,P]),N=r.useCallback((()=>{"hover"===(null==d?void 0:d.action)&&(P||null===M.current?P&&(null!==x.current&&self.clearTimeout(x.current),x.current=self.setTimeout((()=>{A(!1),x.current=null}),500)):(self.clearTimeout(M.current),M.current=null))}),[d,P]),F=r.useCallback((()=>{"hover"===(null==d?void 0:d.action)&&null!==x.current&&(self.clearTimeout(x.current),x.current=null)}),[d]),q=r.useCallback((()=>{"hover"===(null==d?void 0:d.action)&&(null!==x.current&&self.clearTimeout(x.current),x.current=self.setTimeout((()=>{A(!1),x.current=null}),500))}),[d]),z=()=>{P||A(!0),R(0)},j=()=>{P||A(!0),R(L.length-1)},H=()=>{var e;null===(e=I.current)||void 0===e||e.focus(),A(!1)},G=e=>{e.disabled||e.onClick(),H()};r.useEffect((()=>{null!==k&&setTimeout((()=>{var e;return null===(e=C[k])||void 0===e?void 0:e.focus()}),0)}),[k]),r.useEffect((()=>{P||R(null),null==m||m(P)}),[P]),r.useEffect((()=>()=>{null!==x.current?self.clearTimeout(x.current):null!==M.current&&self.clearTimeout(M.current)}),[]);const U=r.useCallback((e=>{var t,i;const n=e.composedPath()[0],r=n instanceof Node&&(null===(t=I.current)||void 0===t?void 0:t.contains(n)),o=n instanceof Node&&(null===(i=S.current)||void 0===i?void 0:i.contains(n));!P||r||o||A(!1)}),[P]);r.useEffect((()=>(P?self.addEventListener("mousedown",U):self.removeEventListener("mousedown",U),()=>self.removeEventListener("mousedown",U))),[P]);const V=({item:e,children:t})=>e.disabled&&e.tooltip?r.createElement(c.u,{withCenteredGrammarlyIcon:!0,message:e.tooltip,showDelay:0},t):t,{ref:B,onMount:J}=o.P.useElWatcher();r.useEffect((()=>{const e=B.pipe(a.oA,l.b((e=>null==E?void 0:E(e.getAttribute("id")||"item-id",e)))).subscribe();return()=>e.unsubscribe()}),[]);const $=r.createElement("dl",{id:e,"aria-labelledby":T,role:"menu",ref:S,...(0,s.Sh)(h().popoverMenu,"lightDS"===_?h().popoverMenuLightDS:null),onKeyDown:e=>{let t=!1;"ArrowUp"===e.key?((()=>{let e=(k||0)-1;e<0&&(e=L.length-1),R(e)})(),t=!0):"ArrowDown"===e.key?((()=>{let e=(k||0)+1;e>=L.length&&(e=0),R(e)})(),t=!0):"Home"===e.key?(z(),t=!0):"End"===e.key?(j(),t=!0):"Escape"===e.key?(H(),t=!0):"Tab"===e.key&&A(!1),t&&(e.stopPropagation(),e.preventDefault())},onMouseEnter:F,onMouseLeave:q},i.map(((e,t)=>(0,n.zG)(e.items.map(((e,i)=>{var n;const o=null!==(n=e.id)&&void 0!==n?n:`popover-menu-item-${t}-${i}`,a=`${o}-label`;return r.createElement(V,{key:o,item:e},r.createElement("dd",{id:o,"aria-labelledby":a,role:"menuitem",tabIndex:-1,...(0,s.Sh)(h().popoverMenuItem,"lightDS"===_?h().popoverMenuItemLightDS:null,e.disabled?h().disabledPopoverMenuItem:null),onClick:()=>G(e),onKeyDown:t=>{let i=!1;" "===t.key||"Enter"===t.key?(G(e),i=!0):"Escape"===t.key&&(H(),i=!0),i&&(t.stopPropagation(),t.preventDefault())},ref:e=>{J(e),C.push(e)}},r.createElement("div",{...(0,s.Sh)(h().popoverMenuItemLabel,D?h().popoverMenuItemLabelWithIcon:null)},D?r.createElement("div",{className:h().popoverMenuItemLabelIcon},e.icon):null,r.createElement("span",{id:a},e.label))))})),(i=>{var n;return"lightDS"===_?r.createElement("div",{key:`popover-menu-section-${t}`,...(0,s.Sh)(h().popoverMenuSectionLightDS,t>0?h().popoverMenuSectionSeparatorLightDS:null)},r.createElement("dt",null),i):r.createElement(r.Fragment,{key:`popover-menu-section-${t}`},r.createElement("dt",{...(0,s.Sh)(e.title?h().popoverMenuSectionTitle:null,!e.title&&t>0?h().popoverMenuSectionSeparator:null)},null!==(n=e.title)&&void 0!==n?n:""),i)})))));return r.createElement(u.J,{dataGrammarlyPart:w,isOutsideReferenceElement:!1,mainContent:$,show:P,placement:p,showArrow:!1,size:v,includeMainContentPadding:!1,referenceElementStyle:f,distanceFromReferenceElement:y,style:{...b,..."lightDS"===_?{borderRadius:4}:{}}},r.createElement("div",{id:T,"aria-label":t,"aria-haspopup":"true","aria-controls":e,"aria-expanded":P,tabIndex:0,role:"button",className:h().popoverMenuTriggerElement,style:f,ref:I,onClick:W,onMouseEnter:O,onMouseLeave:N,onKeyDown:e=>{let t=!1;"click"===(null==d?void 0:d.action)&&(" "===e.key||"Enter"===e.key)||"ArrowDown"===e.key?(z(),t=!0):"ArrowUp"===e.key?(j(),t=!0):"Escape"===e.key?(H(),t=!0):"Tab"===e.key&&A(!1),t&&(e.stopPropagation(),e.preventDefault())}},r.cloneElement(g,{tabIndex:-1})))}},38582:(e,t,i)=>{i.d(t,{p:()=>s});var n=i(49231);if(6168!=i.j)var r=i(47897);var o=i(38957);const s=({headerIcon:e="logo-with-name",title:t,message:i,children:s,show:a=!1,placement:l="auto",onClose:c,style:u})=>n.createElement(r.J,{isOutsideReferenceElement:!1,headerIcon:e,mainContent:n.createElement("div",{className:o.popoverMessageMainContent},n.createElement("div",{className:o.popoverMessageMainContentTitle},t),i&&n.createElement("div",{className:o.popoverMessageMainContentText},i)),show:a,placement:l,onClose:c,style:u},s)},15449:(e,t,i)=>{i.d(t,{d:()=>o,p:()=>s});var n=i(49231),r=i(14188);const o=n.createContext(r.Q),s=({children:e})=>n.createElement(o.Provider,{value:r.Q},e)},14188:(e,t,i)=>{i.d(t,{Q:()=>r});var n=i(62552);const r=new class{constructor(){this._currentRef=0,this._tooltipsSubject=new n.X(null),this.tooltips=this._tooltipsSubject.asObservable()}show(e){this.hide(this._currentRef);const t=e.showDelay||0;return this._timeoutHandler=setTimeout((()=>{this._tooltipsSubject.next(e)}),t),++this._currentRef}hide(e){e===this._currentRef&&(this.clearTimeout(),this._tooltipsSubject.next(null))}clearTimeout(){null!==this._timeoutHandler&&(clearTimeout(this._timeoutHandler),this._timeoutHandler=null)}}},22408:(e,t,i)=>{i.d(t,{u:()=>p});var n=i(49231),r=i(84308),o=i(954),s=i(29416),a=i(63532),l=i(62365),c=i(30051),u=i(88927),d=i(25965),h=i(15449);const p=n.forwardRef((function({children:e,message:t,position:i="top",showDelay:p=100,style:m,offset:g,disabled:f=!1,withGrammarlyIcon:v=!1,withCenteredGrammarlyIcon:_=!1,forcedMessage:b,onHideTooltip:y},w){const[E,S]=(0,l.Y)(),C=n.useRef(null),I=n.useContext(h.d),T=n.useRef(null),P=(0,c.K)(b),A=(0,c.K)(f),k=(0,c.K)(t),R=n.useCallback((()=>{T.current&&(I.hide(T.current),T.current=null,null==y||y())}),[]);n.useEffect((()=>{var e,t,i;return null===(i=null===(t=null===(e=C.current)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===i||i.addEventListener("scroll",R),()=>{var e,t,i;return null===(i=null===(t=null===(e=C.current)||void 0===e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===i?void 0:i.removeEventListener("scroll",R)}}),[C]);const M=(0,r.a)([E.pipe((0,o.O)(!1)),P,A,k]);(0,u.A)(M.pipe((0,s.b)(p),(0,a.b)((([e,t,n,r])=>{(e||t)&&!n&&null===T.current&&C.current&&r&&(T.current=I.show({message:null!=t?t:r,position:i,style:m,offset:g,anchor:C.current.getBoundingClientRect(),withGrammarlyIcon:v,withCenteredGrammarlyIcon:_}))})))),(0,u.A)(M.pipe((0,a.b)((([e,t,i,n])=>{(e||t)&&!i&&null===T.current&&C.current&&n||R()})))),(0,u.A)(A.pipe((0,a.b)((e=>e&&R())))),n.useEffect((()=>()=>R()),[]);const x={ref:(0,d.l)([w,C,...(0,d.O)(e)?[e.ref]:[]],S)};return n.cloneElement(e,x)}))},42373:(e,t,i)=>{i.d(t,{n:()=>o});var n=i(49231);if(6168!=i.j)var r=i(57065);const o=({color:e=r.Z.neutral50})=>n.createElement("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n.createElement("path",{d:"M21.0202 11.6869C21.2155 11.4916 21.2155 11.175 21.0202 10.9798C20.825 10.7845 20.5084 10.7845 20.3131 10.9798L21.0202 11.6869ZM10.9798 20.3131C10.7845 20.5084 10.7845 20.825 10.9798 21.0202C11.175 21.2155 11.4916 21.2155 11.6869 21.0202L10.9798 20.3131ZM20.3131 10.9798L10.9798 20.3131L11.6869 21.0202L21.0202 11.6869L20.3131 10.9798ZM16 23.5C20.1421 23.5 23.5 20.1421 23.5 16H22.5C22.5 19.5899 19.5899 22.5 16 22.5V23.5ZM23.5 16C23.5 11.8579 20.1421 8.5 16 8.5V9.5C19.5899 9.5 22.5 12.4101 22.5 16H23.5ZM16 8.5C11.8579 8.5 8.5 11.8579 8.5 16H9.5C9.5 12.4101 12.4101 9.5 16 9.5V8.5ZM8.5 16C8.5 20.1421 11.8579 23.5 16 23.5V22.5C12.4101 22.5 9.5 19.5899 9.5 16H8.5Z",fill:e}))},25103:(e,t,i)=>{i.d(t,{_:()=>W});var n=i(49231),r=i(68823),o=i(34527);const s=96,a=o.ux.keyframes({from:{backgroundPosition:"0 0"},to:{backgroundPosition:`${o.ux.px(-3264)} 0`}}),l={height:o.ux.px(s),width:o.ux.px(s),transformOrigin:"top left"},c={width:s,height:s,backgroundImage:`url(${r.y}proofitColorChange.png)`,animation:`${a} ${o.ux.seconds(2)} steps(34) forwards 1`,animationFillMode:"forwards"},u={width:s,height:s,backgroundImage:`url(${r.y}proofitColorChange.png)`,backgroundPosition:[0,0]},d={width:s,height:s,backgroundImage:`url(${r.y}proofitColorChange.png)`,backgroundPosition:[0,-3264]},h=o.ux.style(c),p=o.ux.style(d),m=o.ux.style(u),g=o.ux.style(l),f=({size:e})=>n.createElement("div",{style:{height:e,width:e}},n.createElement("div",{className:g,style:{transform:`scale(${e/s})`}},n.createElement("div",{className:h}))),v=({size:e})=>n.createElement("div",{style:{height:e,width:e}},n.createElement("div",{className:g,style:{transform:`scale(${e/s})`}},n.createElement("div",{className:p}))),_=({size:e})=>n.createElement("div",{style:{height:e,width:e}},n.createElement("div",{className:g,style:{transform:`scale(${e/s})`}},n.createElement("div",{className:m}))),b=96,y=o.ux.keyframes({from:{backgroundPosition:"0 0"},to:{backgroundPosition:`${o.ux.px(-8544)} 0`}}),w={height:o.ux.px(b),width:o.ux.px(b),transformOrigin:"top left"},E={width:b,height:b,backgroundImage:`url(${r.y}proofitSparkle.png)`,animation:`${y} ${o.ux.seconds(2)} steps(89) forwards 1`,animationFillMode:"forwards"},S=o.ux.style(E),C=o.ux.style(w),I=({size:e})=>n.createElement("div",{style:{height:e,width:e}},n.createElement("div",{className:C,style:{transform:`scale(${e/b})`}},n.createElement("div",{className:S})));var T,P=i(22408),A=i(46180),k=i(38582);!function(e){e.emphasizedToEnabled="emphasizedToEnabled",e.enabledToEnabled="enabledToEnabled",e.emphasized="emphasized",e.disabled="disabled",e.enabled="enabled"}(T||(T={}));var R=i(48008),M=i(23031),x=i(94438);function L(e){const t=n.useRef();return n.useEffect((()=>{t.current=e})),t.current}const D=({prevIsDisabled:e,isDisabled:t,prevIsEmphasized:i,isEmphasized:r})=>{const o=(a=t,l=i,c=r,(s=e)||!l||a||c?s||l||a||c?c?T.emphasized:a?T.disabled:T.enabled:T.enabledToEnabled:T.emphasizedToEnabled);var s,a,l,c;switch(o){case T.emphasizedToEnabled:case T.enabledToEnabled:return n.createElement(v,{size:20});case T.enabled:return n.createElement(f,{size:20});case T.emphasized:return n.createElement(I,{size:20});case T.disabled:return n.createElement(_,{size:20});default:(0,M.vE)(o)}},W=({style:e,onClick:t,disabledInfo:i,isEmphasized:r,showPopup:o,onPopupClose:s,disableIntroTooltip:a,popupStyle:l})=>{var c,u;const d=!!i,h=null===(c=L(d))||void 0===c||c,p=null!==(u=L(r))&&void 0!==u&&u,m=n.createElement("div",{"data-grammarly-part":"proofit-button",className:x.proofitButtonIcon,style:e},n.createElement(A.h,{onClick:t,disabled:d},n.createElement(D,{isDisabled:d,prevIsDisabled:h,isEmphasized:r,prevIsEmphasized:p})));if(d)return n.createElement(P.u,{showDelay:0,message:n.createElement(R.Q,{info:i,includeTitle:!0}),withGrammarlyIcon:!0},m);if(o){let e,t,i="";return"canceled"===o?(e="logo-with-name",i="Your request was canceled."):"error"===o?(e="logo-error",i="Something went wrong.",t="Please try again later."):"rejected"===o&&(e="logo-error",i="Order canceled by writing experts.",t=n.createElement(n.Fragment,null,n.createElement("a",{target:"_blank",rel:"noreferrer",href:"https://support.grammarly.com/hc/en-us/articles/360024803951-Expert-writing-service-submission-stand"},"See our submission guidelines"),". We'll refund your credit to use on a different email.")),n.createElement(k.p,{show:Boolean(o),title:i,message:t,onClose:s,placement:"top",headerIcon:e,style:l},m)}return n.createElement(P.u,{showDelay:1e3,message:n.createElement(n.Fragment,null,n.createElement("b",null,"Are you writing an important email?"),n.createElement("br",null),"Learn how to get instant help from our team of writing experts."),withGrammarlyIcon:!0,disabled:a},m)};W.defaultProps={disabledInfo:null,disableIntroTooltip:!1}},76211:(e,t,i)=>{i.d(t,{R:()=>c});var n=i(49231),r=i(22408),o=i(83349),s=i.n(o),a=i(41102),l=i.n(a);const c=({originalText:e,width:t,height:i,top:o,left:a,zIndex:c,position:u})=>n.createElement("div",{"data-grammarly-part":"proofit-highlight",style:{width:t,height:i,top:o,left:a,zIndex:c,position:u}},n.createElement(r.u,{showDelay:0,message:n.createElement("div",{className:l().proofitHighlightTooltip},e),disabled:0===e.trim().length},n.createElement("div",{className:s().proofitHighlight})));c.defaultProps={zIndex:"auto",position:"fixed"}},78708:(e,t,i)=>{i.d(t,{B:()=>h});var n=i(49231);if(6168!=i.j)var r=i(37213);if(6168!=i.j)var o=i(57065);if(6168!=i.j)var s=i(41038);if(6168!=i.j)var a=i(23951);if(6168!=i.j)var l=i(46180);if(6168!=i.j)var c=i(42373);var u=i(68692),d=i(71529);const h=e=>{const t=e=>{let t=Math.round(e);return t>100?t=100:t<0&&(t=0),t},i=e.isCompleted?null:60===e.turnaroundTime?"1 minute":`${e.turnaroundTime} seconds`;return n.createElement("div",{"data-grammarly-part":"proofit-in-progress-tab",style:e.style},n.createElement("div",{className:d.proofitInProgressTab},n.createElement("div",{className:d.proofitInProgressTabContent},n.createElement("div",{...(0,r.Sh)(d.proofitInProgressTabTitleContainer,e.secondaryTitle?d.proofitInProgressTabTitleContainerMultiple:null)},n.createElement("span",{...(0,r.Sh)(d.proofitInProgressTabTitle,d.proofitInProgressTabTitleMain)},e.title),e.secondaryTitle?n.createElement("span",{...(0,r.Sh)(d.proofitInProgressTabTitle,d.proofitInProgressTabTitleSecondary)},e.secondaryTitle):null),e.isCompleted?n.createElement(s.z,{onClick:e.onReview,kind:"success",size:"small"},"Review"):t(e.progress)<100?n.createElement(a.m,{ariaMenuId:"proofit-in-progress-tab-actions-menu",ariaMenuLabel:"Proofit In-Progress Tab Actions Menu",sections:[{items:[e.allowCancellation?{icon:n.createElement(c.n,{color:o.Z.neutral50}),label:"Cancel order",onClick:e.onCancel}:{icon:n.createElement(c.n,{color:o.Z.neutral40}),label:"Cancel order",disabled:!0,tooltip:i?`Request cancellation is available only if the review takes more than ${i}.`:void 0}]}],placement:"top-end",onToggle:e.onToggleMenu},n.createElement(l.h,{kind:"transparent"},n.createElement("div",{className:u.proofitInProgressTabMenuIcon}))):null),e.isCompleted||e.hideProgressBar?null:n.createElement("div",{className:d.proofitInProgressTabCompletionBar,style:{width:`${t(e.progress)}%`}})))}},48008:(e,t,i)=>{i.d(t,{Q:()=>a});var n=i(49231),r=i(23031),o=i(26590);const s=e=>{if(e.reason===o.rS.NO_FREE_TRIALS_LEFT){const t="No email reviews left this month";let i;if(e.meta.quotaResetDate){const t=Intl.DateTimeFormat([],{month:"short",day:"numeric"}).format(new Date(Date.parse(e.meta.quotaResetDate)));i=`You will get ${o.SR} free reviews again next month (${t}). You can also use paid expert writing help in Grammarly's web editor anytime.`}else i=`You will get ${o.SR} free reviews again next month. You can also use paid expert writing help in Grammarly's web editor anytime.`;return{title:t,message:i}}return e.reason===o.rS.NOT_ENOUGH_WORDS?{message:`Your email must be at least ${o.fy} words (currently ${e.meta.wordsCount}).`}:e.reason===o.rS.TOO_MANY_WORDS?{message:`Your email must be under ${o.Vw} words (currently ${e.meta.wordsCount}).`}:(e=>{switch(e){case o.rS.NOT_AVAILABLE:return{message:"Our experts are currently working on other text. Please try again later."};case o.rS.NOT_AVAILABLE_QUOTA_ERROR:return{title:"Something went wrong",message:"We couldn't determine how many requests you have left. Please try again later."};case o.rS.CONFLICTING_REQUEST:return{title:"Separate request in progress",message:"You can submit this request once the experts are finished with the one you already submitted."};case o.rS.CHECKING_INITIAL_AVAILABILITY:return{message:"Checking for available experts..."};case o.rS.UNSUPPORTED_LANGUAGE:return{message:"Our writing experts can only help with emails written in English."};default:(0,r.vE)(e)}})(e.reason)},a=({info:e,includeTitle:t})=>{const i=s(e);return n.createElement(n.Fragment,null,t?n.createElement(n.Fragment,null,i.title?n.createElement("b",null,i.title):n.createElement("b",null,"Get expert writing help"),n.createElement("br",null)):null,i.message)};a.defaultProps={includeTitle:!1}},41580:(e,t,i)=>{i.d(t,{b:()=>r});var n=i(49231);const r=({children:e})=>{const t="string"==typeof e?e:"";return t?n.createElement("style",{dangerouslySetInnerHTML:{__html:t}}):null}},62365:(e,t,i)=>{i.d(t,{Y:()=>m});var n=i(49231),r=i(55341),o=i(44071),s=i(90572),a=i(24666),l=i(20161),c=i(21070),u=i(14969),d=i(29479),h=i(954),p=i(23031);function m(){const e=n.useRef(new r.t(1)),t=n.useRef(e.current.pipe((0,s.h)(p.fQ),(0,a.x)(),(0,l.w)((e=>(0,o.R)(e,"mouseover").pipe((0,c.z)((()=>(0,o.R)(e,"mouseleave").pipe((0,u.P)(),(0,d.h)(!1),(0,h.O)(!0))))))))),i=n.useCallback((t=>e.current.next(t)),[e.current]);return[t.current,i]}},30051:(e,t,i)=>{i.d(t,{K:()=>o});var n=i(49231),r=i(62552);function o(e){const t=n.useRef(new r.X(e));return n.useEffect((()=>{t.current.next(e)}),[e]),t.current}},88927:(e,t,i)=>{i.d(t,{A:()=>r});var n=i(49231);function r(e){n.useEffect((()=>{const t=e.subscribe();return()=>t.unsubscribe()}),[])}},57065:(e,t,i)=>{i.d(t,{Z:()=>r});var n=i(21734);const r={neutral0:n.White,neutral20:n.Blue0,neutral40:n.BlueGray35,neutral50:n.BlueGray60,neutral90:n.BlueGray100,blue40:n.Blue40,blue50:n.Blue40,green50:n.Green40,red40:n.Red40,red50:n.Red60,yellow20:n.Gold20,yellow50:n.Gold40,yellow60:n.Gold40,yellow80:n.Gold90,purple40:n.Purple40}},25965:(e,t,i)=>{function n(e,t){return i=>{e.forEach((e=>{"function"==typeof e?e(i):e&&(e.current=i),null==t||t(i)}))}}function r(e){return"ref"in e&&(null===e.ref||"function"==typeof e.ref||"object"==typeof e.ref&&"current"in e.ref)}i.d(t,{O:()=>r,l:()=>n})},73563:(e,t,i)=>{i.d(t,{e:()=>s});var n=i(49231),r=i(15716),o=i(14263);const s=n.memo((function(e){const{level:t="warning",size:i}=e,s=(0,r.hj)(i)?i:o.lk,a="warning"===t?o.bd.yellow:o.bd.red,l=s*o.Kj/o.lk;return n.createElement("svg",{width:l,height:s,viewBox:`0 0 ${o.Kj} ${o.lk}`,fill:"none",xmlns:"http://www.w3.org/2000/svg",className:e.className},n.createElement("path",{d:"M13 .625C6.166.625.626 6.165.626 13v12.375h12.379c.851 0 1.686-.085 2.492-.25 5.64-1.156 9.88-6.144 9.88-12.124C25.375 6.165 19.835.625 13 .625Z",fill:o.bd.green,stroke:"white"}),n.createElement("path",{d:"M21.305 11.864h-5.408l-1.273 2.206h4.459c-.7 3.836-4.966 6.448-9.23 4.239a5.02 5.02 0 0 1-2.145-2.125c-2.453-4.67.898-9.368 5.32-9.368 1.822 0 3.464.798 4.592 2.064l1.143-1.98a8.31 8.31 0 0 0-6.325-2.266c-4.172.288-7.554 3.746-7.757 7.92-.231 4.795 3.6 8.766 8.344 8.766 4.742 0 8.355-3.749 8.355-8.355a8.48 8.48 0 0 0-.076-1.101ZM26 14.166l5.052 9.625H20.948L26 14.166Z",fill:o.bd.white}),n.createElement("path",{d:"m24.404 13.88.436.245-.436-.245-5.22 9.281c-.693 1.23.16 2.808 1.595 2.808h10.442c1.436 0 2.288-1.577 1.596-2.808l-5.221-9.281a1.823 1.823 0 0 0-3.192 0ZM26 17.219a.32.32 0 0 1 .32.32v2.734a.32.32 0 1 1-.64 0V17.54a.32.32 0 0 1 .32-.32Zm.32 5.789a.32.32 0 1 1-.64 0 .32.32 0 0 1 .64 0Z",fill:a,stroke:o.bd.white}))}))},95071:e=>{e.exports={button:"Xv6nu",buttonRound:"wsrpG",buttonWithPadding:"aaYpW",buttonSmall:"zi_ja",buttonMedium:"KumoA",buttonTransparent:"uQ7bn",buttonOutlined:"v1SWt",buttonLink:"XiP1W",buttonEnabled:"FfbwC",buttonPrimary:"u8dZN",buttonSuccess:"bx7Ao",buttonTransparentHoverable:"QJ7SS",buttonDark:"R0C6b",buttonNeutral:"Glsdy",buttonNeutralWhite:"Xxwoy",buttonPremium:"FyfT4",buttonDisabled:"VMMkP",secondaryText:"xYKB9"}},41249:e=>{e.exports={closeButtonMediumIcon:"xMSt8",closeButtonSmallIcon:"KJIVs",closeButtonWhiteIcon:"vwkk7",spin:"DgOJb"}},54429:e=>{e.exports={pane:"Rktrz",paneDark:"Iackh",paneDarkDS:"Egf_e",paneSmall:"Zglu8",paneMedium:"KDiTE",paneLarge:"Ut6iQ",paneExtraLarge:"JyayS",paneHeaderContentContainer:"w7cHF",paneHeaderContentContainerWithCloseButton:"sJfMe",paneHeaderContent:"cRXvV",paneHeaderContentIcon:"mYqjL",paneHeaderContentIconNotificationOK:"D98fm",paneHeaderContentIconNotificationWarning:"y9R1h",paneMainContent:"lafeo",paneMainContentWithoutPadding:"M2ZM4",spin:"IMGhE"}},3538:e=>{e.exports={popoverArrowElement:"m0jPP",popoverArrowElementBottom:"X6ecE",popoverArrowElementDark:"m12bb",popoverArrowElementDarkDS:"EKEQa",popoverArrowElementTop:"NsYpj",popoverArrowElementRight:"IQwgo",popoverArrowElementLeft:"k4czK"}},42527:e=>{e.exports={popoverReferenceElement:"WEkke",lightDSPopover:"IjZe9"}},79707:e=>{e.exports={popoverMenuTriggerElement:"nURov",popoverMenu:"Ij6SI",popoverMenuLightDS:"O_T5O",popoverMenuSectionTitle:"EF47u",popoverMenuSectionSeparator:"hiFzz",popoverMenuSectionSeparatorLightDS:"AFz96",popoverMenuSectionLightDS:"G04S7",popoverMenuItem:"wt6uR",popoverMenuItemLightDS:"ct1Rs",disabledPopoverMenuItem:"hJmoX",popoverMenuItemLabel:"jgsgt",popoverMenuItemLabelWithIcon:"l6_mK",popoverMenuItemLabelIcon:"DD9ET"}},38957:e=>{e.exports={popoverMessageMainContent:"_Uk7Q",popoverMessageMainContentTitle:"cC_NJ",popoverMessageMainContentText:"PMeLZ"}},94438:e=>{e.exports={proofitButtonIcon:"_2_gky"}},83349:e=>{e.exports={proofitHighlight:"NhBeP"}},41102:e=>{e.exports={proofitHighlightTooltip:"tSle0"}},68692:e=>{e.exports={proofitInProgressTabMenuIcon:"tLtQX",spin:"rboIv"}},71529:e=>{e.exports={proofitInProgressTab:"tdDUP",proofitInProgressTabContent:"ce2CZ",proofitInProgressTabTitleContainer:"cxFB6",proofitInProgressTabTitle:"JvWll",proofitInProgressTabTitleContainerMultiple:"z4LLE",proofitInProgressTabTitleMain:"JJZ_J",fade:"_vabv",proofitInProgressTabTitleSecondary:"BhhB7",proofitInProgressTabCompletionBar:"fRd8e"}},77671:e=>{e.exports={gr_no_print:"dnXmp"}}}]);